{
    "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PTERODACTYL PANEL - PTERODACTYL.IO",
    "meta": {
        "version": "PTDL_v2",
        "update_url": null
    },
    "exported_at": "2026-01-09T16:53:53+00:00",
    "name": "StarRupture",
    "author": "eggs@goover.dev",
    "description": "StarRupture is a first-person open-world base building game with advanced combat and tons of exploration. Play alone or with up to 4 friends on this sublime and everchanging planet, extract and manage resources, create your complex industrial system, and fight off hordes of alien monsters.",
    "features": [
        "steam_disk_space"
    ],
    "docker_images": {
        "ghcr.io\/goover\/steam:proton": "ghcr.io\/goover\/steam:proton"
    },
    "file_denylist": [],
    "startup": "proton run .\/StarRupture\/Binaries\/Win64\/StarRuptureServerEOS-Win64-Shipping.exe -port={{SERVER_PORT}} -log & SR_PID=$! ; tail -c0 -F .\/StarRupture\/Saved\/Logs\/StarRupture.log --pid=$SR_PID",
    "config": {
        "files": "{\n  \"DSSettings.txt\": {\n    \"parser\": \"json\",\n    \"find\": {\n      \"SessionName\": \"{{server.build.env.SESSION_NAME}}\",\n      \"SaveGameInterval\": \"{{server.build.env.SAVE_INTERVAL}}\",\n      \"StartNewGame\": \"{{server.build.env.START_NEW}}\",\n      \"LoadSavedGame\": \"{{server.build.env.LOAD_SAVE}}\",\n      \"SaveGameName\": \"{{server.build.env.SAVEGAME_NAME}}\"\n    }\n  }\n}",
        "startup": "{\n    \"done\": \"OnUpdateSessionComplete(SessionName: GameSession, bWasSuccessful: true\"\n}",
        "logs": "{}",
        "stop": "^C"
    },
    "scripts": {
        "installation": {
            "script": "#!\/bin\/bash\r\n# ------------------------------------------------\r\n# Generic Installscript Template for Pelican Eggs (Linux)\r\n# License: AGPLv3\r\n# Author: gOOvER (https:\/\/discord.goover.dev)\r\n# Donate: https:\/\/donate.goover.dev\r\n# ------------------------------------------------\r\n\r\nset -euo pipefail  # Strict error handling\r\n\r\n# ----------------------------\r\n# Environment Setup\r\n# ----------------------------\r\nHOME=\/mnt\/server\r\nexport HOME\r\n\r\n# Ensure \/mnt is owned by root\r\nchown -R root:root \/mnt\r\n\r\nGAME_NAME=\"StarRupture\"   # <--- name of the game (internal placeholder)\r\nCONFIG_INIT=1\r\nCONFIG_FILE_NAME=\"DSSettings.txt\"      # <--- configurable config filename (internal)\r\nCONFIG_DIR=\"$HOME\/\" # <--- adjustable per game\r\nCONFIG_URL=\"https:\/\/raw.githubusercontent.com\/gsrvtech\/gameserver-templates\/refs\/heads\/main\/steamcmd-games\/starrupture\/config\/DSSettings.txt\"                  # <--- adjustable per game\r\nSTEAMCMD_DIR=\"$HOME\/steamcmd\"              # <--- SteamCMD directory\r\n\r\nSTEAM_USER=\"${STEAM_USER:-anonymous}\"\r\nSTEAM_PASS=\"${STEAM_PASS:-}\"\r\nSTEAM_AUTH=\"${STEAM_AUTH:-}\"\r\nDEPOTDOWNLOADER=\"${DEPOTDOWNLOADER:-0}\"\r\n: \"${STEAM_APPID:?Environment variable STEAM_APPID must be set for $GAME_NAME}\"  # mandatory\r\n\r\n# ----------------------------\r\n# Locale Setup to suppress warnings\r\n# ----------------------------\r\nexport LANG=en_US.UTF-8\r\nexport LANGUAGE=en_US:en\r\nexport LC_ALL=en_US.UTF-8\r\n\r\n# ----------------------------\r\n# Logging Setup\r\n# ----------------------------\r\nSAFE_NAME=\"${GAME_NAME\/\/ \/_}_install.log\"\r\nINSTALL_LOG=\"$HOME\/$SAFE_NAME\"\r\n\r\n# Initialize log file\r\n: > \"$INSTALL_LOG\"\r\n\r\n# ----------------------------\r\n# Colors\r\n# ----------------------------\r\nRED=$(tput setaf 1 2>\/dev\/null || echo \"\")\r\nGREEN=$(tput setaf 2 2>\/dev\/null || echo \"\")\r\nYELLOW=$(tput setaf 3 2>\/dev\/null || echo \"\")\r\nBLUE=$(tput setaf 4 2>\/dev\/null || echo \"\")\r\nCYAN=$(tput setaf 6 2>\/dev\/null || echo \"\")\r\nWHITE=$(tput setaf 7 2>\/dev\/null || echo \"\")\r\nBOLD=$(tput bold 2>\/dev\/null || echo \"\")\r\nNC=$(tput sgr0 2>\/dev\/null || echo \"\")\r\n\r\nLINE=\"${BLUE}════════════════════════════════════════════════════════════════${NC}\"\r\n\r\n# ----------------------------\r\n# Logging Functions\r\n# ----------------------------\r\nlog_info()    { \r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') ${BLUE}[INFO]${NC} $*\"\r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] $*\" >> \"$INSTALL_LOG\"\r\n}\r\nlog_warn()    { \r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') ${YELLOW}[WARN]${NC} $*\"\r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] $*\" >> \"$INSTALL_LOG\"\r\n}\r\nlog_error()   { \r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') ${RED}[ERROR]${NC} $*\" >&2\r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] $*\" >> \"$INSTALL_LOG\"\r\n}\r\nlog_success() { \r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') ${GREEN}[ OK ]${NC} $*\"\r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [ OK ] $*\" >> \"$INSTALL_LOG\"\r\n}\r\n\r\n# Visual output functions (no timestamps for clean display)\r\nprint_step()    { \r\n    echo \"${BLUE}│${NC}  ${CYAN}→${NC} $*\"\r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [STEP] $*\" >> \"$INSTALL_LOG\"\r\n}\r\nprint_ok()      { \r\n    echo \"${BLUE}│${NC}  ${GREEN}✓${NC} $*\"\r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] $*\" >> \"$INSTALL_LOG\"\r\n}\r\nprint_warn()    { \r\n    echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} $*\"\r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] $*\" >> \"$INSTALL_LOG\"\r\n}\r\nprint_error()   { \r\n    echo \"${BLUE}│${NC}  ${RED}✗${NC} $*\" >&2\r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] $*\" >> \"$INSTALL_LOG\"\r\n}\r\n\r\n# Centered text in box (width=64 total, 62 between borders)\r\nprint_centered() {\r\n    local text=\"$1\"\r\n    local color=\"$2\"\r\n    local box_width=62\r\n    # Remove ANSI codes for length calculation\r\n    local clean_text=$(printf \"%s\" \"$text\" | sed 's\/\\x1b\\[[0-9;]*m\/\/g')\r\n    local text_len=${#clean_text}\r\n    local total_padding=$((box_width - text_len))\r\n    local left_pad=$((total_padding \/ 2))\r\n    local right_pad=$((total_padding - left_pad))\r\n    printf \"${BLUE}║${NC}%*s%s%s%s%*s${BLUE}║${NC}\\n\" \"$left_pad\" \"\" \"$color\" \"$text\" \"${NC}\" \"$right_pad\" \"\"\r\n}\r\n\r\n# Progress indication removed - causes issues with output redirection\r\n\r\n# ----------------------------\r\n# System Check Function\r\n# ----------------------------\r\nsystem_check() {\r\n    local sys_info_file=\"$HOME\/system_info.txt\"\r\n    \r\n    echo \"\"\r\n    echo \"${BLUE}╔════════════════════════════════════════════════════════════════╗${NC}\"\r\n    # \"SYSTEM INFORMATION CHECK\" = 24 chars, (64-24)\/2 = 20 left, 20 right\r\n    printf \"${BLUE}║${NC}%20s${CYAN}${BOLD}%s${NC}%20s${BLUE}║${NC}\\n\" \"\" \"SYSTEM INFORMATION CHECK\" \"\"\r\n    echo \"${BLUE}╚════════════════════════════════════════════════════════════════╝${NC}\"\r\n    echo \"\"\r\n    \r\n    # Initialize system info file\r\n    {\r\n        echo \"==================================================================\"\r\n        echo \"                   SYSTEM INFORMATION CHECK\"\r\n        echo \"==================================================================\"\r\n        echo \"Date: $(date '+%Y-%m-%d %H:%M:%S')\"\r\n        echo \"==================================================================\"\r\n        echo \"\"\r\n    } > \"$sys_info_file\"\r\n    \r\n    # Kernel Information\r\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}Kernel Information${NC}\"\r\n    if command -v uname &> \/dev\/null; then\r\n        local kernel_name\r\n        local kernel_version\r\n        local distro_name=\"Unknown\"\r\n        local distro_version=\"\"\r\n        \r\n        kernel_name=$(uname -s)\r\n        kernel_version=$(uname -r)\r\n        \r\n        # Detect Linux distribution (pure bash, no external tools)\r\n        if [[ -f \/etc\/os-release ]]; then\r\n            # Modern standard (systemd-based distros, Alpine, etc.)\r\n            while IFS='=' read -r key value; do\r\n                value=\"${value%\\\"}\"\r\n                value=\"${value#\\\"}\"\r\n                case \"$key\" in\r\n                    PRETTY_NAME) distro_name=\"$value\" ;;\r\n                    VERSION_ID) distro_version=\"$value\" ;;\r\n                esac\r\n            done < \/etc\/os-release\r\n        elif [[ -f \/etc\/lsb-release ]]; then\r\n            # LSB-compliant distros\r\n            while IFS='=' read -r key value; do\r\n                value=\"${value%\\\"}\"\r\n                value=\"${value#\\\"}\"\r\n                case \"$key\" in\r\n                    DISTRIB_DESCRIPTION) distro_name=\"$value\" ;;\r\n                    DISTRIB_RELEASE) distro_version=\"$value\" ;;\r\n                esac\r\n            done < \/etc\/lsb-release\r\n        elif [[ -f \/etc\/alpine-release ]]; then\r\n            distro_name=\"Alpine Linux\"\r\n            distro_version=$(cat \/etc\/alpine-release 2>\/dev\/null)\r\n        elif [[ -f \/etc\/debian_version ]]; then\r\n            distro_name=\"Debian\"\r\n            distro_version=$(cat \/etc\/debian_version 2>\/dev\/null)\r\n        elif [[ -f \/etc\/redhat-release ]]; then\r\n            distro_name=$(cat \/etc\/redhat-release 2>\/dev\/null)\r\n        elif [[ -f \/etc\/arch-release ]]; then\r\n            distro_name=\"Arch Linux\"\r\n        elif [[ -f \/etc\/gentoo-release ]]; then\r\n            distro_name=$(cat \/etc\/gentoo-release 2>\/dev\/null)\r\n        elif [[ -f \/etc\/SuSE-release ]]; then\r\n            distro_name=$(head -n1 \/etc\/SuSE-release 2>\/dev\/null)\r\n        elif [[ -f \/etc\/issue ]]; then\r\n            # Fallback to \/etc\/issue (strip escape sequences)\r\n            distro_name=$(head -n1 \/etc\/issue 2>\/dev\/null | sed 's\/\\\\[a-z]\/\/g' | xargs)\r\n        fi\r\n        \r\n        # Fallback if still unknown\r\n        [[ \"$distro_name\" == \"Unknown\" || -z \"$distro_name\" ]] && distro_name=\"$kernel_name\"\r\n        \r\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Distro:  ${WHITE}${distro_name}${NC}\"\r\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Kernel:  ${WHITE}${kernel_version}${NC}\"\r\n        {\r\n            echo \"KERNEL INFORMATION:\"\r\n            echo \"  Distro:  ${distro_name}\"\r\n            echo \"  Kernel:  ${kernel_version}\"\r\n            echo \"\"\r\n        } >> \"$sys_info_file\"\r\n    else\r\n        echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Kernel information not available\"\r\n        echo \"Kernel Information: Not available\" >> \"$sys_info_file\"\r\n        echo \"\" >> \"$sys_info_file\"\r\n    fi\r\n    echo \"${BLUE}└─${NC}\"\r\n    \r\n    # CPU Information\r\n    echo \"\"\r\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}CPU Information${NC}\"\r\n    if [[ -f \/proc\/cpuinfo ]]; then\r\n        local cpu_model\r\n        local cpu_cores\r\n        cpu_model=$(grep \"model name\" \/proc\/cpuinfo | head -n1 | cut -d':' -f2 | xargs)\r\n        cpu_cores=$(grep -c \"^processor\" \/proc\/cpuinfo)\r\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Model:   ${WHITE}${cpu_model}${NC}\"\r\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Cores:   ${WHITE}${cpu_cores}${NC}\"\r\n        {\r\n            echo \"CPU INFORMATION:\"\r\n            echo \"  Model: ${cpu_model}\"\r\n            echo \"  Cores: ${cpu_cores}\"\r\n            echo \"\"\r\n        } >> \"$sys_info_file\"\r\n    else\r\n        echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} CPU information not available\"\r\n        echo \"CPU Information: Not available\" >> \"$sys_info_file\"\r\n        echo \"\" >> \"$sys_info_file\"\r\n    fi\r\n    echo \"${BLUE}└─${NC}\"\r\n    \r\n    # Virtualization Detection\r\n    echo \"\"\r\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}Virtualization${NC}\"\r\n    local virt_status=\"Unknown\"\r\n    if command -v systemd-detect-virt &> \/dev\/null; then\r\n        virt_status=$(systemd-detect-virt 2>\/dev\/null || echo \"none\")\r\n        if [[ \"$virt_status\" == \"none\" ]]; then\r\n            echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Type:    ${GREEN}Bare Metal (No Virtualization)${NC}\"\r\n            virt_status=\"Bare Metal\"\r\n        else\r\n            echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Type:    ${YELLOW}${virt_status}${NC}\"\r\n        fi\r\n    elif [[ -f \/proc\/cpuinfo ]]; then\r\n        if grep -qE \"^flags.*hypervisor\" \/proc\/cpuinfo; then\r\n            echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Type:    ${YELLOW}Virtualized (hypervisor detected)${NC}\"\r\n            virt_status=\"Virtualized (hypervisor flag present)\"\r\n        else\r\n            echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Type:    ${GREEN}Likely Bare Metal${NC}\"\r\n            virt_status=\"Likely Bare Metal\"\r\n        fi\r\n    else\r\n        echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Type:    ${YELLOW}Cannot determine${NC}\"\r\n    fi\r\n    {\r\n        echo \"VIRTUALIZATION:\"\r\n        echo \"  Type: ${virt_status}\"\r\n        echo \"\"\r\n    } >> \"$sys_info_file\"\r\n    echo \"${BLUE}└─${NC}\"\r\n    \r\n    # Memory (RAM) Information\r\n    echo \"\"\r\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}Memory (RAM)${NC}\"\r\n    if [[ -f \/proc\/meminfo ]]; then\r\n        local total_ram_kb\r\n        local total_ram_mb\r\n        local total_ram_gb\r\n        local available_ram_kb\r\n        local available_ram_mb\r\n        local available_ram_gb\r\n        local used_ram_mb\r\n        local ram_percent\r\n        \r\n        total_ram_kb=$(grep \"MemTotal\" \/proc\/meminfo | awk '{print $2}')\r\n        total_ram_mb=$((total_ram_kb \/ 1024))\r\n        # Pure bash decimal calculation (integer.decimal)\r\n        total_ram_gb=\"$((total_ram_mb \/ 1024)).$((total_ram_mb * 100 \/ 1024 % 100))\"\r\n        \r\n        available_ram_kb=$(grep \"MemAvailable\" \/proc\/meminfo | awk '{print $2}')\r\n        available_ram_mb=$((available_ram_kb \/ 1024))\r\n        available_ram_gb=\"$((available_ram_mb \/ 1024)).$((available_ram_mb * 100 \/ 1024 % 100))\"\r\n        \r\n        used_ram_mb=$((total_ram_mb - available_ram_mb))\r\n        # Calculate percentage with one decimal place using pure bash\r\n        ram_percent=\"$((used_ram_mb * 100 \/ total_ram_mb)).$((used_ram_mb * 1000 \/ total_ram_mb % 10))\"\r\n        \r\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Total:     ${WHITE}${total_ram_mb} MB${NC} ${BLUE}(${WHITE}${total_ram_gb} GB${BLUE})${NC}\"\r\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Available: ${WHITE}${available_ram_mb} MB${NC} ${BLUE}(${WHITE}${available_ram_gb} GB${BLUE})${NC}\"\r\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Used:      ${WHITE}${used_ram_mb} MB${NC}\"\r\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Usage:     ${YELLOW}${ram_percent}%${NC}\"\r\n        \r\n        {\r\n            echo \"MEMORY (RAM):\"\r\n            echo \"  Total:     ${total_ram_mb} MB (${total_ram_gb} GB)\"\r\n            echo \"  Available: ${available_ram_mb} MB (${available_ram_gb} GB)\"\r\n            echo \"  Used:      ${used_ram_mb} MB\"\r\n            echo \"  Usage:     ${ram_percent}%\"\r\n            echo \"\"\r\n        } >> \"$sys_info_file\"\r\n    else\r\n        echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Memory information not available\"\r\n        echo \"Memory (RAM): Not available\" >> \"$sys_info_file\"\r\n        echo \"\" >> \"$sys_info_file\"\r\n    fi\r\n    echo \"${BLUE}└─${NC}\"\r\n    \r\n    # Disk Space Information\r\n    echo \"\"\r\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}Disk Space (Home Directory)${NC}\"\r\n    if command -v df &> \/dev\/null; then\r\n        local disk_info\r\n        local disk_total\r\n        local disk_used\r\n        local disk_available\r\n        local disk_percent\r\n        \r\n        disk_info=$(df -h \"$HOME\" 2>\/dev\/null | tail -n1)\r\n        disk_total=$(echo \"$disk_info\" | awk '{print $2}')\r\n        disk_used=$(echo \"$disk_info\" | awk '{print $3}')\r\n        disk_available=$(echo \"$disk_info\" | awk '{print $4}')\r\n        disk_percent=$(echo \"$disk_info\" | awk '{print $5}')\r\n        \r\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Total:     ${WHITE}${disk_total}${NC}\"\r\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Used:      ${WHITE}${disk_used}${NC} ${YELLOW}(${disk_percent})${NC}\"\r\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Available: ${WHITE}${disk_available}${NC}\"\r\n        \r\n        {\r\n            echo \"DISK SPACE (Home Directory):\"\r\n            echo \"  Total:     ${disk_total}\"\r\n            echo \"  Used:      ${disk_used} (${disk_percent})\"\r\n            echo \"  Available: ${disk_available}\"\r\n            echo \"\"\r\n        } >> \"$sys_info_file\"\r\n    else\r\n        echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Disk information not available\"\r\n        echo \"Disk Space: Not available\" >> \"$sys_info_file\"\r\n        echo \"\" >> \"$sys_info_file\"\r\n    fi\r\n    echo \"${BLUE}└─${NC}\"\r\n    \r\n    echo \"\"\r\n    {\r\n        echo \"==================================================================\"\r\n        echo \"                  END OF SYSTEM INFORMATION\"\r\n        echo \"==================================================================\"\r\n    } >> \"$sys_info_file\"\r\n    \r\n    # Only log to file, no screen output\r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] System information saved to: ${sys_info_file}\" >> \"$INSTALL_LOG\"\r\n    echo \"\"\r\n}\r\n\r\n# ----------------------------\r\n# Validation Functions\r\n# ----------------------------\r\nvalidate_steam_appid() {\r\n    if [[ ! \"$STEAM_APPID\" =~ ^[0-9]+$ ]]; then\r\n        log_error \"STEAM_APPID must be numeric: $STEAM_APPID\"\r\n        exit 1\r\n    fi\r\n}\r\n\r\nvalidate_config_url() {\r\n    # Only validate if CONFIG_INIT is enabled\r\n    if [[ \"${CONFIG_INIT:-0}\" -eq 1 ]] && [[ -n \"$CONFIG_URL\" ]]; then\r\n        if [[ ! \"$CONFIG_URL\" =~ ^https?:\/\/[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}(\/.*)?$ ]]; then\r\n            log_error \"CONFIG_URL must be a valid HTTP\/HTTPS URL: $CONFIG_URL\"\r\n            exit 1\r\n        fi\r\n        \r\n        # Check for suspicious URLs\r\n        if [[ \"$CONFIG_URL\" =~ (localhost|127\\.0\\.0\\.1|0\\.0\\.0\\.0|::1) ]]; then\r\n            log_warn \"CONFIG_URL points to localhost - this may be intentional but could be suspicious\"\r\n        fi\r\n    fi\r\n}\r\n\r\n# New function for additional security checks\r\nvalidate_steam_credentials() {\r\n    # Check for suspicious characters in Steam credentials\r\n    local suspicious_chars='[;&|`$()]'\r\n    \r\n    if [[ \"$STEAM_USER\" =~ $suspicious_chars ]]; then\r\n        log_error \"STEAM_USER contains suspicious characters\"\r\n        exit 1\r\n    fi\r\n    \r\n    if [[ -n \"$STEAM_PASS\" ]] && [[ \"$STEAM_PASS\" =~ $suspicious_chars ]]; then\r\n        log_error \"STEAM_PASS contains suspicious characters\"\r\n        exit 1\r\n    fi\r\n    \r\n    if [[ -n \"$STEAM_AUTH\" ]] && [[ \"$STEAM_AUTH\" =~ $suspicious_chars ]]; then\r\n        log_error \"STEAM_AUTH contains suspicious characters\"\r\n        exit 1\r\n    fi\r\n}\r\n\r\nvalidate_path() {\r\n    local path=\"$1\"\r\n    local name=\"$2\"\r\n    \r\n    # Check for path traversal attempts\r\n    if [[ \"$path\" =~ \\.\\.\/\\.\\. ]] || [[ \"$path\" =~ ^\/etc ]] || [[ \"$path\" =~ ^\/root ]]; then\r\n        log_error \"Invalid or dangerous path for $name: $path\"\r\n        exit 1\r\n    fi\r\n    \r\n    # Ensure path starts with $HOME\r\n    if [[ ! \"$path\" =~ ^\"$HOME\" ]]; then\r\n        log_error \"Path $name must start with HOME directory: $path\"\r\n        exit 1\r\n    fi\r\n}\r\n\r\ncheck_dependencies() {\r\n    local deps=(\"curl\" \"tar\")\r\n    local missing=()\r\n    local optional_deps=(\"wget\" \"unzip\")\r\n    \r\n    # Check if curl supports HTTPS\r\n    local curl_https_support=false\r\n    if command -v curl >\/dev\/null 2>&1; then\r\n        if curl --version 2>\/dev\/null | grep -q \"https\"; then\r\n            curl_https_support=true\r\n        else\r\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] curl found but HTTPS support is missing\" >> \"$INSTALL_LOG\"\r\n        fi\r\n    else\r\n        missing+=(\"curl\")\r\n    fi\r\n    \r\n    for dep in \"${deps[@]}\"; do\r\n        if ! command -v \"$dep\" >\/dev\/null 2>&1; then\r\n            missing+=(\"$dep\")\r\n        fi\r\n    done\r\n    \r\n    # Try to install missing dependencies automatically\r\n    if [[ \"${#missing[@]}\" -gt 0 ]] || [[ \"$curl_https_support\" == \"false\" ]]; then\r\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] Attempting to install missing dependencies...\" >> \"$INSTALL_LOG\"\r\n        \r\n        # Alpine Linux\r\n        if command -v apk >\/dev\/null 2>&1; then\r\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] Detected Alpine Linux, installing packages...\" >> \"$INSTALL_LOG\"\r\n            apk add --no-cache curl ca-certificates openssl tar wget 2>\/dev\/null || {\r\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Failed to install packages via apk\" >> \"$INSTALL_LOG\"\r\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Missing required dependencies: ${missing[*]}\" >> \"$INSTALL_LOG\"\r\n                print_error \"Failed to install packages via apk\"\r\n                exit 1\r\n            }\r\n        # Debian\/Ubuntu\r\n        elif command -v apt-get >\/dev\/null 2>&1; then\r\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] Detected Debian\/Ubuntu, installing packages...\" >> \"$INSTALL_LOG\"\r\n            export DEBIAN_FRONTEND=noninteractive\r\n            apt-get update >\/dev\/null 2>&1 || true\r\n            apt-get install -y curl ca-certificates openssl tar wget gnupg2 2>\/dev\/null || {\r\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Failed to install packages via apt-get\" >> \"$INSTALL_LOG\"\r\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Missing required dependencies: ${missing[*]}\" >> \"$INSTALL_LOG\"\r\n                print_error \"Failed to install packages via apt-get\"\r\n                exit 1\r\n            }\r\n            # Update CA certificates to ensure HTTPS works properly\r\n            update-ca-certificates >\/dev\/null 2>&1 || true\r\n        else\r\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Unsupported Linux distribution\" >> \"$INSTALL_LOG\"\r\n            print_error \"Unsupported Linux distribution\"\r\n            exit 1\r\n        fi\r\n        \r\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] Dependencies installed successfully\" >> \"$INSTALL_LOG\"\r\n    fi\r\n    \r\n    # Re-check dependencies after installation\r\n    missing=()\r\n    for dep in \"${deps[@]}\"; do\r\n        if ! command -v \"$dep\" >\/dev\/null 2>&1; then\r\n            missing+=(\"$dep\")\r\n        fi\r\n    done\r\n    \r\n    if [[ \"${#missing[@]}\" -gt 0 ]]; then\r\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Still missing dependencies after installation: ${missing[*]}\" >> \"$INSTALL_LOG\"\r\n        print_error \"Still missing dependencies after installation: ${missing[*]}\"\r\n        exit 1\r\n    fi\r\n    \r\n    # Check optional dependencies\r\n    for dep in \"${optional_deps[@]}\"; do\r\n        if ! command -v \"$dep\" >\/dev\/null 2>&1; then\r\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] Optional dependency missing: $dep\" >> \"$INSTALL_LOG\"\r\n        fi\r\n    done\r\n    \r\n    # Check system requirements\r\n    if [[ \"$(nproc 2>\/dev\/null || echo 1)\" -lt 2 ]]; then\r\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] System has less than 2 CPU cores\" >> \"$INSTALL_LOG\"\r\n    fi\r\n    \r\n    local available_memory\r\n    available_memory=\"$(awk '\/MemAvailable\/ {print int($2\/1024)}' \/proc\/meminfo 2>\/dev\/null || echo 0)\"\r\n    if [[ \"$available_memory\" -lt 1024 ]]; then\r\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] Less than 1GB available memory\" >> \"$INSTALL_LOG\"\r\n    fi\r\n    \r\n    # Only log to file, no screen output\r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] All required dependencies found\" >> \"$INSTALL_LOG\"\r\n}\r\n\r\n# ----------------------------\r\n# Download with Retry Function\r\n# ----------------------------\r\n# shellcheck disable=SC2317  # Function is called later in script\r\ndownload_with_retry() {\r\n    local url=\"$1\" \r\n    local output=\"$2\" \r\n    local retries=\"${3:-3}\"\r\n    local desc=\"${4:-file}\"\r\n    local expected_size=\"${5:-}\"\r\n    \r\n    # Validate URL format\r\n    if [[ ! \"$url\" =~ ^https?:\/\/[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}(\/.*)?$ ]]; then\r\n        log_error \"Invalid URL format: $url\"\r\n        return 1\r\n    fi\r\n    \r\n    # Check if HTTPS is supported by curl\r\n    local curl_supports_https=true\r\n    if ! curl --version 2>\/dev\/null | grep -q \"https\"; then\r\n        curl_supports_https=false\r\n        log_warn \"HTTPS not supported by curl, will try HTTP fallback\"\r\n    fi\r\n    \r\n    for i in $(seq 1 \"$retries\"); do\r\n        log_info \"Downloading $desc (attempt $i\/$retries)...\"\r\n        \r\n        # Determine which URLs to try based on HTTPS support\r\n        local urls_to_try=()\r\n        if [[ \"$url\" =~ ^https:\/\/ ]]; then\r\n            if [[ \"$curl_supports_https\" == \"true\" ]]; then\r\n                # Try HTTPS first, then HTTP as fallback\r\n                urls_to_try=(\"$url\" \"${url\/https:\/http:}\")\r\n            else\r\n                # Only try HTTP if HTTPS is not supported\r\n                urls_to_try=(\"${url\/https:\/http:}\")\r\n                log_warn \"Using HTTP instead of HTTPS: ${url\/https:\/http:}\"\r\n            fi\r\n        else\r\n            # URL is already HTTP\r\n            urls_to_try=(\"$url\")\r\n        fi\r\n        \r\n        local success=false\r\n        local last_error=\"\"\r\n        \r\n        for try_url in \"${urls_to_try[@]}\"; do\r\n            # Use appropriate curl options based on protocol\r\n            local curl_opts=(\r\n                -fsSL\r\n                --connect-timeout 30\r\n                --max-time 300\r\n                --retry 1\r\n                --retry-delay 1\r\n                --location\r\n                -H \"User-Agent: GameServer-Installer\/1.0\"\r\n                -o \"$output\"\r\n            )\r\n            \r\n            # Add protocol restrictions based on URL and support\r\n            if [[ \"$try_url\" =~ ^https:\/\/ ]]; then\r\n                curl_opts+=(--proto '=https' --tlsv1.2)\r\n            else\r\n                curl_opts+=(--proto '=http')\r\n            fi\r\n            \r\n            last_error=$(curl \"${curl_opts[@]}\" \"$try_url\" 2>&1)\r\n            if [[ \"$?\" -eq 0 ]]; then\r\n                success=true\r\n                break\r\n            fi\r\n        done\r\n        \r\n        if [[ \"$success\" == \"true\" ]]; then\r\n            # Verify download\r\n            if [[ -f \"$output\" ]]; then\r\n                local file_size\r\n                file_size=\"$(stat -f%z \"$output\" 2>\/dev\/null || stat -c%s \"$output\" 2>\/dev\/null || echo 0)\"\r\n                \r\n                if [[ \"$file_size\" -gt 0 ]]; then\r\n                    if [[ -n \"$expected_size\" ]] && [[ \"$file_size\" -lt \"$expected_size\" ]]; then\r\n                        log_warn \"Downloaded file seems too small ($file_size bytes, expected at least $expected_size)\"\r\n                    fi\r\n                    log_success \"Downloaded $desc successfully ($file_size bytes)\"\r\n                    return 0\r\n                else\r\n                    log_error \"Downloaded file is empty\"\r\n                    rm -f \"$output\"\r\n                fi\r\n            fi\r\n        else\r\n            if [[ -n \"$last_error\" ]]; then\r\n                log_warn \"Download failed: $last_error\"\r\n            fi\r\n        fi\r\n        \r\n        if [[ \"$i\" -lt \"$retries\" ]]; then\r\n            log_warn \"Download attempt $i failed, retrying in 5 seconds...\"\r\n            sleep 5\r\n        fi\r\n    done\r\n    \r\n    log_error \"Failed to download $desc after $retries attempts\"\r\n    return 1\r\n}\r\n\r\n# ----------------------------\r\n# Safe command execution\r\n# ----------------------------\r\nrun_or_fail() {\r\n    local desc=\"$1\"; shift\r\n    # Only log to file, no screen output\r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] Starting: $desc\" >> \"$INSTALL_LOG\"\r\n    \r\n    if \"$@\" >> \"$INSTALL_LOG\" 2>&1; then\r\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] $desc\" >> \"$INSTALL_LOG\"\r\n    else\r\n        local exit_code=$?\r\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] $desc failed with exit code $exit_code\" >> \"$INSTALL_LOG\"\r\n        print_error \"$desc failed (exit code $exit_code)\"\r\n        exit 1\r\n    fi\r\n}\r\n\r\n# ----------------------------\r\n# Cleanup Function\r\n# ----------------------------\r\ncleanup() {\r\n    local exit_code=$?\r\n    \r\n    # Only log cleanup on errors\r\n    if [[ \"$exit_code\" -ne 0 ]]; then\r\n        log_info \"Cleaning up temporary files...\"\r\n    fi\r\n    \r\n    # Remove temporary files\r\n    rm -f \/tmp\/steamcmd.tar.gz \/tmp\/depotdownloader.zip \/tmp\/steam_output.log\r\n    \r\n    # Clean up any leftover processes\r\n    pkill -f \"steamcmd\" 2>\/dev\/null || true\r\n    pkill -f \"DepotDownloader\" 2>\/dev\/null || true\r\n    \r\n    # Clear sensitive variables\r\n    unset STEAM_PASS STEAM_AUTH\r\n    \r\n    if [[ \"$exit_code\" -ne 0 ]]; then\r\n        log_error \"Script exited with error code $exit_code\"\r\n        log_info \"Check the installation log at: $INSTALL_LOG\"\r\n    fi\r\n    \r\n    exit \"$exit_code\"\r\n}\r\n\r\ntrap cleanup EXIT\r\n\r\n# ----------------------------\r\n# Secure Steam Command Execution\r\n# ----------------------------\r\nrun_steam_command() {\r\n    local -a cmd_array=()\r\n    local desc=\"$2\"\r\n    \r\n    # Parse command array from first argument\r\n    eval \"cmd_array=($1)\"\r\n    \r\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] Executing: $desc\" >> \"$INSTALL_LOG\"\r\n    \r\n    local exit_code=0\r\n    \r\n    # Show progress output on screen while filtering sensitive data\r\n    # SteamCMD outputs download progress which we want to show\r\n    echo \"${BLUE}│${NC}\"\r\n    \"${cmd_array[@]}\" 2>&1 | while IFS= read -r line; do\r\n        # Log everything (filtered) to file\r\n        echo \"$line\" | grep -v -iE \"password|auth|token|secret\" >> \"$INSTALL_LOG\" 2>\/dev\/null || true\r\n        \r\n        # Show progress lines on screen (update%, downloading, validating)\r\n        if [[ \"$line\" =~ (Update|Downloading|Validating|progress|[0-9]+%) ]] || \\\r\n           [[ \"$line\" =~ ^\\ *\\[.*\\] ]] || \\\r\n           [[ \"$line\" =~ \"Success\" ]] || \\\r\n           [[ \"$line\" =~ \"Depot download\" ]]; then\r\n            # Filter out sensitive information before display\r\n            local safe_line\r\n            safe_line=$(echo \"$line\" | grep -v -iE \"password|auth|token|secret|login\")\r\n            if [[ -n \"$safe_line\" ]]; then\r\n                printf \"${BLUE}│${NC}  ${WHITE}%s${NC}\\n\" \"$safe_line\"\r\n            fi\r\n        fi\r\n    done\r\n    exit_code=${PIPESTATUS[0]}\r\n    echo \"${BLUE}│${NC}\"\r\n    \r\n    # Log results\r\n    case \"$exit_code\" in\r\n        0) echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] $desc completed successfully\" >> \"$INSTALL_LOG\" ;;\r\n        2) \r\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Steam login failed - check credentials\" >> \"$INSTALL_LOG\"\r\n            print_error \"Steam login failed\"\r\n            ;;\r\n        5) \r\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] App not found or access denied for AppID: $STEAM_APPID\" >> \"$INSTALL_LOG\"\r\n            print_error \"App not found (AppID: $STEAM_APPID)\"\r\n            ;;\r\n        7) \r\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Steam is updating, please try again later\" >> \"$INSTALL_LOG\"\r\n            print_error \"Steam is updating\"\r\n            ;;\r\n        *) \r\n            if [[ \"$exit_code\" -ne 0 ]]; then\r\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] $desc exited with code $exit_code\" >> \"$INSTALL_LOG\"\r\n            fi\r\n            ;;\r\n    esac\r\n    \r\n    return \"$exit_code\"\r\n}\r\n\r\n# ----------------------------\r\n# Start Script Output\r\n# ----------------------------\r\nclear\r\necho \"\"\r\necho \"${BLUE}╔════════════════════════════════════════════════════════════════╗${NC}\"\r\n# \"GAME INSTALLATION\" = 17 chars, (64-17)\/2 = 23 left, 24 right\r\nprintf \"${BLUE}║${NC}%23s${YELLOW}${BOLD}%s${NC}%24s${BLUE}║${NC}\\n\" \"\" \"GAME INSTALLATION\" \"\"\r\n# \"${GAME_NAME}\" - dynamisch berechnet\r\ngame_name_len=${#GAME_NAME}\r\ngame_left=$(( (64 - game_name_len) \/ 2 ))\r\ngame_right=$(( 64 - game_name_len - game_left ))\r\nprintf \"${BLUE}║${NC}%*s${WHITE}%s${NC}%*s${BLUE}║${NC}\\n\" \"$game_left\" \"\" \"${GAME_NAME}\" \"$game_right\" \"\"\r\necho \"${BLUE}╚════════════════════════════════════════════════════════════════╝${NC}\"\r\necho \"\"\r\n\r\n# ----------------------------\r\n# System Check\r\n# ----------------------------\r\nsystem_check\r\n\r\n# ----------------------------\r\n# Pre-flight Checks\r\n# ----------------------------\r\necho \"\"\r\necho \"${BLUE}┌─ ${CYAN}${BOLD}Pre-flight Checks${NC}\"\r\nprint_step \"Validating environment...\"\r\ncheck_dependencies\r\nprint_step \"Validating Steam App ID...\"\r\nvalidate_steam_appid\r\nprint_step \"Validating configuration...\"\r\nvalidate_config_url\r\nprint_step \"Validating Steam credentials...\"\r\nvalidate_steam_credentials\r\nprint_step \"Validating paths...\"\r\nvalidate_path \"$CONFIG_DIR\" \"CONFIG_DIR\"\r\nvalidate_path \"$STEAMCMD_DIR\" \"STEAMCMD_DIR\"\r\nprint_ok \"All checks passed\"\r\necho \"${BLUE}└─${NC}\"\r\n\r\n# Check network connectivity\r\necho \"\"\r\necho \"${BLUE}┌─ ${CYAN}${BOLD}Network Connectivity${NC}\"\r\nif ! curl -s --connect-timeout 10 --max-time 15 \"https:\/\/steamcdn-a.akamaihd.net\" >\/dev\/null 2>&1; then\r\n    print_warn \"HTTPS failed, trying HTTP...\"\r\n    if ! curl -s --connect-timeout 10 --max-time 15 \"http:\/\/steamcdn-a.akamaihd.net\" >\/dev\/null 2>&1; then\r\n        print_error \"Cannot reach Steam servers\"\r\n        echo \"${BLUE}└─${NC}\"\r\n        exit 1\r\n    else\r\n        print_ok \"HTTP connection verified\"\r\n    fi\r\nelse\r\n    print_ok \"HTTPS connection verified\"\r\nfi\r\necho \"${BLUE}└─${NC}\"\r\n\r\necho \"\"\r\nif [[ \"$STEAM_USER\" == \"anonymous\" ]]; then\r\n    echo \"${BLUE}•${NC} ${YELLOW}Using anonymous Steam login${NC}\"\r\nelse\r\n    echo \"${BLUE}•${NC} ${CYAN}Steam user:${NC} ${WHITE}$STEAM_USER${NC}\"\r\nfi\r\n\r\n# ----------------------------\r\n# Game Installation via DepotDownloader\r\n# ----------------------------\r\nif [[ \"$DEPOTDOWNLOADER\" == \"1\" ]]; then\r\n    echo \"\"\r\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}Game Installation (DepotDownloader)${NC}\"\r\n    print_step \"Installing $GAME_NAME...\"\r\n    mkdir -p \"$HOME\/depotdownloader\"\r\n    cd \"$HOME\/depotdownloader\"\r\n\r\n    if [[ ! -f DepotDownloader ]]; then\r\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] Fetching DepotDownloader Linux binary...\" >> \"$INSTALL_LOG\"\r\n        run_or_fail \"Download DepotDownloader\" \\\r\n            download_with_retry \\\r\n            \"https:\/\/github.com\/SteamRE\/DepotDownloader\/releases\/latest\/download\/DepotDownloader-Linux-x64\" \\\r\n            \"DepotDownloader\" \\\r\n            3 \\\r\n            \"DepotDownloader binary\"\r\n        \r\n        run_or_fail \"Make DepotDownloader executable\" chmod +x DepotDownloader\r\n    fi\r\n\r\n    # Build DepotDownloader command array\r\n    declare -a dd_cmd=(\r\n        \".\/DepotDownloader\"\r\n        \"-app\" \"$STEAM_APPID\"\r\n        \"-dir\" \"$HOME\"\r\n    )\r\n    \r\n    if [[ -n \"${STEAM_BETAID:-}\" ]]; then\r\n        dd_cmd+=(\"-beta\" \"$STEAM_BETAID\")\r\n    fi\r\n    \r\n    if [[ -n \"${STEAM_BETAPASS:-}\" ]]; then\r\n        dd_cmd+=(\"-betapassword\" \"$STEAM_BETAPASS\")\r\n    fi\r\n    \r\n    # Add install flags if provided\r\n    if [[ -n \"${INSTALL_FLAGS:-}\" ]]; then\r\n        read -ra flags <<< \"$INSTALL_FLAGS\"\r\n        dd_cmd+=(\"${flags[@]}\")\r\n    fi\r\n    \r\n    dd_cmd+=(\"-username\" \"$STEAM_USER\")\r\n    \r\n    if [[ -n \"$STEAM_PASS\" ]]; then\r\n        dd_cmd+=(\"-password\" \"$STEAM_PASS\")\r\n    fi\r\n    \r\n    if [[ -n \"$STEAM_AUTH\" ]]; then\r\n        dd_cmd+=(\"-remember-password\" \"$STEAM_AUTH\")\r\n    fi\r\n\r\n    # Convert array to string for run_steam_command\r\n    cmd_string=\"\"\r\n    printf -v cmd_string '%q ' \"${dd_cmd[@]}\"\r\n    \r\n    run_steam_command \"$cmd_string\" \"DepotDownloader installation\"\r\n    print_ok \"Installation finished\"\r\n    echo \"${BLUE}└─${NC}\"\r\nfi\r\n\r\n# ----------------------------\r\n# Game Installation via SteamCMD\r\n# ----------------------------\r\nif [[ \"$DEPOTDOWNLOADER\" != \"1\" ]]; then\r\n    echo \"\"\r\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}Game Installation (SteamCMD)${NC}\"\r\n    print_step \"Installing $GAME_NAME...\"\r\n    mkdir -p \"$STEAMCMD_DIR\" \"$HOME\/steamapps\"\r\n\r\n    run_or_fail \"Download SteamCMD\" \\\r\n        download_with_retry \\\r\n        \"http:\/\/steamcdn-a.akamaihd.net\/client\/installer\/steamcmd_linux.tar.gz\" \\\r\n        \"\/tmp\/steamcmd.tar.gz\" \\\r\n        3 \\\r\n        \"SteamCMD archive\"\r\n    \r\n    run_or_fail \"Extract SteamCMD\" tar -xzf \/tmp\/steamcmd.tar.gz -C \"$STEAMCMD_DIR\"\r\n\r\n    cd \"$STEAMCMD_DIR\"\r\n\r\n    # Build SteamCMD command array\r\n    declare -a steam_cmd=(\r\n        \".\/steamcmd.sh\"\r\n        \"+force_install_dir\" \"$HOME\"\r\n        \"+login\" \"$STEAM_USER\"\r\n    )\r\n    \r\n    if [[ -n \"$STEAM_PASS\" ]]; then\r\n        steam_cmd+=(\"$STEAM_PASS\")\r\n    fi\r\n    \r\n    if [[ -n \"$STEAM_AUTH\" ]]; then\r\n        steam_cmd+=(\"$STEAM_AUTH\")\r\n    fi\r\n    \r\n    if [[ \"${WINDOWS_INSTALL:-0}\" == \"1\" ]]; then\r\n        steam_cmd+=(\"+@sSteamCmdForcePlatformType\" \"windows\")\r\n    fi\r\n    \r\n    steam_cmd+=(\"+app_update\" \"$STEAM_APPID\" \"+app_update\" \"1007\")\r\n    \r\n    if [[ -n \"${STEAM_BETAID:-}\" ]]; then\r\n        steam_cmd+=(\"-beta\" \"$STEAM_BETAID\")\r\n    fi\r\n    \r\n    if [[ -n \"${STEAM_BETAPASS:-}\" ]]; then\r\n        steam_cmd+=(\"-betapassword\" \"$STEAM_BETAPASS\")\r\n    fi\r\n    \r\n    # Add install flags if provided\r\n    if [[ -n \"${INSTALL_FLAGS:-}\" ]]; then\r\n        read -ra flags <<< \"$INSTALL_FLAGS\"\r\n        steam_cmd+=(\"${flags[@]}\")\r\n    fi\r\n    \r\n    steam_cmd+=(\"validate\" \"+quit\")\r\n\r\n    # Convert array to string for run_steam_command\r\n    cmd_string=\"\"\r\n    printf -v cmd_string '%q ' \"${steam_cmd[@]}\"\r\n    \r\n    run_steam_command \"$cmd_string\" \"SteamCMD installation\"\r\n    print_ok \"Installation finished\"\r\n    echo \"${BLUE}└─${NC}\"\r\nfi\r\n\r\n# ----------------------------\r\n# Steam Libraries Setup\r\n# ----------------------------\r\necho \"\"\r\necho \"${BLUE}┌─ ${CYAN}${BOLD}Steam Libraries Setup${NC}\"\r\nmkdir -p \"$HOME\/.steam\/sdk32\" \"$HOME\/.steam\/sdk64\"\r\n\r\nif [[ -f \"$STEAMCMD_DIR\/linux32\/steamclient.so\" ]]; then\r\n    if cp -v \"$STEAMCMD_DIR\/linux32\/steamclient.so\" \"$HOME\/.steam\/sdk32\/steamclient.so\" >\/dev\/null 2>&1; then\r\n        print_ok \"32-bit Steam library copied\"\r\n    else\r\n        print_warn \"Failed to copy 32-bit library\"\r\n    fi\r\nelse\r\n    print_warn \"32-bit Steam library not found\"\r\nfi\r\n\r\nif [[ -f \"$STEAMCMD_DIR\/linux64\/steamclient.so\" ]]; then\r\n    if cp -v \"$STEAMCMD_DIR\/linux64\/steamclient.so\" \"$HOME\/.steam\/sdk64\/steamclient.so\" >\/dev\/null 2>&1; then\r\n        print_ok \"64-bit Steam library copied\"\r\n    else\r\n        print_warn \"Failed to copy 64-bit library\"\r\n    fi\r\nelse\r\n    print_warn \"64-bit library not found\"\r\nfi\r\nprint_ok \"Setup complete\"\r\necho \"${BLUE}└─${NC}\"\r\n\r\n# ----------------------------\r\n# Game-specific Hooks\r\n# ----------------------------\r\necho \"\"\r\necho \"${BLUE}┌─ ${CYAN}${BOLD}Game-specific Hooks${NC}\"\r\nprint_step \"Executing custom commands...\"\r\n# <--- add game-specific commands here\r\nprint_ok \"Hooks completed\"\r\necho \"${BLUE}└─${NC}\"\r\n\r\n# ----------------------------\r\n# Config Setup\r\n# ----------------------------\r\necho \"\"\r\necho \"${BLUE}┌─ ${CYAN}${BOLD}Configuration Setup${NC}\"\r\nif [[ \"${CONFIG_INIT:-0}\" -eq 1 ]]; then\r\n    if [[ -f \"$CONFIG_DIR\/$CONFIG_FILE_NAME\" ]]; then\r\n        print_ok \"$CONFIG_FILE_NAME found\"\r\n    else\r\n        print_warn \"$CONFIG_FILE_NAME not found, fetching default...\"\r\n        mkdir -p \"$CONFIG_DIR\"\r\n        \r\n        run_or_fail \"Download default $CONFIG_FILE_NAME\" \\\r\n            download_with_retry \\\r\n            \"$CONFIG_URL\" \\\r\n            \"$CONFIG_DIR\/$CONFIG_FILE_NAME\" \\\r\n            3 \\\r\n            \"config file\"\r\n        print_ok \"Configuration downloaded\"\r\n    fi\r\nelse\r\n    print_step \"Skipping (CONFIG_INIT != 1)\"\r\nfi\r\necho \"${BLUE}└─${NC}\"\r\n\r\n# ----------------------------\r\n# Final Verification\r\n# ----------------------------\r\necho \"\"\r\necho \"${BLUE}┌─ ${CYAN}${BOLD}Post-Installation Verification${NC}\"\r\n\r\n# Check if Steam libraries were installed correctly\r\nif [[ ! -d \"$HOME\/.steam\" ]]; then\r\n    print_warn \"Steam directory not found\"\r\nfi\r\n\r\n# Check if basic Steam files exist\r\nsteam_files_found=0\r\nif [[ -f \"$HOME\/.steam\/sdk32\/steamclient.so\" ]]; then\r\n    steam_files_found=$((steam_files_found + 1))\r\nfi\r\nif [[ -f \"$HOME\/.steam\/sdk64\/steamclient.so\" ]]; then\r\n    steam_files_found=$((steam_files_found + 1))\r\nfi\r\n\r\nif [[ \"$steam_files_found\" -eq 0 ]]; then\r\n    print_warn \"No Steam libraries found\"\r\nelif [[ \"$steam_files_found\" -eq 1 ]]; then\r\n    print_warn \"Only one Steam library found\"\r\nelse\r\n    print_ok \"Steam libraries installed\"\r\nfi\r\n\r\n# Check if game files were downloaded (safe version)\r\ngame_files=0\r\nif command -v find >\/dev\/null 2>&1; then\r\n    game_files=\"$(find \"$HOME\" -maxdepth 3 -type f \\( -name \"*.exe\" -o -name \"*.so\" -o -name \"*.bin\" \\) 2>\/dev\/null | wc -l || echo 0)\"\r\nfi\r\n\r\nif [[ \"$game_files\" -gt 0 ]]; then\r\n    print_ok \"Found $game_files game files\"\r\nelse\r\n    print_warn \"No executable files found\"\r\nfi\r\n\r\n# Check permissions (non-fatal)\r\nif [[ ! -w \"$HOME\" ]]; then\r\n    print_warn \"HOME directory not writable\"\r\nelse\r\n    print_ok \"Permissions correct\"\r\nfi\r\n\r\n# Check if SteamCMD was extracted successfully\r\nif [[ -f \"$STEAMCMD_DIR\/steamcmd.sh\" ]]; then\r\n    print_ok \"SteamCMD extracted successfully\"\r\nelse\r\n    print_warn \"SteamCMD not found\"\r\nfi\r\nprint_ok \"Verification completed\"\r\necho \"${BLUE}└─${NC}\"\r\n\r\n# ----------------------------\r\n# Cleanup\r\n# ----------------------------\r\necho \"\"\r\necho \"${BLUE}┌─ ${CYAN}${BOLD}Cleanup${NC}\"\r\nprint_step \"Removing temporary files...\"\r\nrm -f \/tmp\/steamcmd.tar.gz \/tmp\/depotdownloader.zip \/tmp\/steam_output.log\r\nprint_ok \"Cleanup complete\"\r\necho \"${BLUE}└─${NC}\"\r\n\r\n# ----------------------------\r\n# Done\r\n# ----------------------------\r\necho \"\"\r\necho \"${BLUE}╔════════════════════════════════════════════════════════════════╗${NC}\"\r\n# \"INSTALLATION COMPLETED\" = 22 chars, (64-22)\/2 = 21 left, 21 right\r\nprintf \"${BLUE}║${NC}%21s${GREEN}${BOLD}%s${NC}%21s${BLUE}║${NC}\\n\" \"\" \"INSTALLATION COMPLETED\" \"\"\r\necho \"${BLUE}╠════════════════════════════════════════════════════════════════╣${NC}\"\r\n# Ohne Emojis - nur ASCII für zuverlässige Ausrichtung\r\n# Zeile 1: \"  [OK] \" = 7 Zeichen, Rest = 57\r\nprintf \"${BLUE}║${NC}  ${GREEN}[OK]${NC} %-57s${BLUE}║${NC}\\n\" \"${GAME_NAME} successfully installed\"\r\n# Zeile 2: \"  Log: \" = 7 Zeichen, Rest = 57\r\nprintf \"${BLUE}║${NC}  Log: %-57s${BLUE}║${NC}\\n\" \"$INSTALL_LOG\"\r\n# Zeile 3: \"  Support: \" = 11 Zeichen, Rest = 53\r\nprintf \"${BLUE}║${NC}  Support: %-53s${BLUE}║${NC}\\n\" \"https:\/\/donate.goover.dev\"\r\necho \"${BLUE}╚════════════════════════════════════════════════════════════════╝${NC}\"\r\necho \"\"\r\n\r\nexit 0",
            "container": "ghcr.io\/goover\/installers:debian",
            "entrypoint": "bash"
        }
    },
    "variables": [
        {
            "name": "[STEAM] AutoUpdate",
            "description": "",
            "env_variable": "AUTO_UPDATE",
            "default_value": "1",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|boolean",
            "field_type": "text"
        },
        {
            "name": "[SERVER] Load saved Game",
            "description": "true → Loads an existing save; false → Skips loading saved data",
            "env_variable": "LOAD_SAVE",
            "default_value": "true",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "[SERVER] Save Intervall",
            "description": "Time between automatic saves (in seconds)",
            "env_variable": "SAVE_INTERVAL",
            "default_value": "300",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|numeric",
            "field_type": "text"
        },
        {
            "name": "[SERVER] Savegame Name",
            "description": "Filename of the save to load; Must exist in the server save directory",
            "env_variable": "SAVEGAME_NAME",
            "default_value": "",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required",
            "field_type": "text"
        },
        {
            "name": "[SERVER] Session Name",
            "description": "Name of the save game session",
            "env_variable": "SESSION_NAME",
            "default_value": "",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|max:20",
            "field_type": "text"
        },
        {
            "name": "[SERVER] Start new Savegame",
            "description": "true → Forces creation of a new world; false → Prevents new save creation; !!!! Only set this to true once when creating a new world !!!!",
            "env_variable": "START_NEW",
            "default_value": "false",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:true,false",
            "field_type": "text"
        },
        {
            "name": "[STEAM] STEAM_APPID",
            "description": "",
            "env_variable": "STEAM_APPID",
            "default_value": "3809400",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|in:3809400",
            "field_type": "text"
        },
        {
            "name": "[STEAM] WINDOWS_INSTALL",
            "description": "",
            "env_variable": "WINDOWS_INSTALL",
            "default_value": "1",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|boolean",
            "field_type": "text"
        }
    ]
}