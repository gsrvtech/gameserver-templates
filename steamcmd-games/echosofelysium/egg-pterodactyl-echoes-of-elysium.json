{
    "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PTERODACTYL PANEL - PTERODACTYL.IO",
    "meta": {
        "version": "PTDL_v2",
        "update_url": null
    },
    "exported_at": "2026-02-14T20:00:04+00:00",
    "name": "Echoes of Elysium",
    "author": "iamtempusthales@gmail.com",
    "description": "Survive the skies in Echoes of Elysium, a co-op airship survival RPG. Build and customize your\nfloating fortress, gather resources, and explore a vast procedural clockwork world with up to 6\nfriends. Battle land and skyborne threats while uncovering mysteries in a paradise on the brink.",
    "features": null,
    "docker_images": {
        "ghcr.io\/goover\/steamcmd:debian": "ghcr.io\/goover\/steamcmd:debian"
    },
    "file_denylist": [],
    "startup": ".\/ElysiumServer --config config.json",
    "config": {
        "files": "{\n    \"config.json\": {\n        \"parser\": \"json\",\n        \"find\": {\n            \"name\": \"{{server.build.env.SERVER_NAME}}\",\n            \"address\": \"0.0.0.0\",\n            \"port\": \"{{server.build.default.port}}\",\n            \"gameDataDir\": \"{{server.build.env.SERVER_DATA}}\",\n            \"worldDataDir\": \"{{server.build.env.SERVER_WORLD}}\",\n            \"logsDir\": \"{{server.build.env.SERVER_LOGS}}\",\n            \"enableProfiling\": \"{{server.build.env.SERVER_PROFILE}}\",\n            \"password\": \"{{server.build.env.SERVER_PASSWORD}}\",\n            \"saveFreqMins\": \"{{server.build.env.SERVER_SAVE_FREQUENCY}}\",\n            \"backupsEnabled\": \"{{server.build.env.SERVER_BACKUPS_ENABLED}}\",\n            \"backupFreqMins\": \"{{server.build.env.SERVER_BACKUPS_FREQUENCY}}\",\n            \"maxBackups\": \"{{server.build.env.SERVER_MAX_BACKUPS}}\"\n        }\n    }\n}",
        "startup": "{\n    \"done\": \"Host service on-line\"\n}",
        "logs": "[]",
        "stop": "^C"
    },
    "scripts": {
        "installation": {
            "script": "#!\/bin\/bash\n# ------------------------------------------------\n# Generic Installscript Template for Pelican Eggs (Linux)\n# License: AGPLv3\n# Author: gOOvER (https:\/\/discord.goover.dev)\n# Donate: https:\/\/donate.goover.dev\n# ------------------------------------------------\n\nset -euo pipefail  # Strict error handling\n\n# ----------------------------\n# Environment Setup\n# ----------------------------\nHOME=\/mnt\/server\nexport HOME\n\n# Ensure \/mnt is owned by root\nchown -R root:root \/mnt\n\n# ----------------------------\n# Game Specific Configuration\n# ----------------------------\nGAME_NAME=\"Echos of Elysium\"   # <--- name of the game (internal placeholder)\n\n# Steam Client AppID for steam_appid.txt (optional, leave empty if not needed)\nSteamAppId=\"${SteamAppId:-}\"  # <--- optional client AppID\n\n# ----------------------------\n# Configuration Initialization\n# ----------------------------\nCONFIG_INIT=1\nCONFIG_FILE_NAME=\"config.json\"      # <--- configurable config filename (internal)\nCONFIG_DIR=\"$HOME\" # <--- adjustable per game\nCONFIG_URL=\"https:\/\/raw.githubusercontent.com\/gsrvtech\/gameserver-templates\/refs\/heads\/main\/steamcmd-games\/echosofelysium\/config\/config.json\"                  # <--- adjustable per game\nSTEAMCMD_DIR=\"$HOME\/steamcmd\"              # <--- SteamCMD directory\n\n# ----------------------------\n# Library Copy Configuration (optional)\n# (\"\/path\/src.so|\/path\/dest.so\" \"\/path\/src2.so|\/path\/dest2.so\")\n# ----------------------------\nLIB_COPY_ITEMS=(\"$HOME\/libsteam_api.so|$HOME\/linux64\/libsteam_api.so\")\n\n# -----------------------------------------------------------------------------------\n# WARNING: Do not modify anything below this line unless you know what you are doing!\n# -----------------------------------------------------------------------------------\n\nSTEAM_USER=\"${STEAM_USER:-anonymous}\"\nSTEAM_PASS=\"${STEAM_PASS:-}\"\nSTEAM_AUTH=\"${STEAM_AUTH:-}\"\nDEPOTDOWNLOADER=\"${DEPOTDOWNLOADER:-0}\"\n: \"${STEAM_APPID:?Environment variable STEAM_APPID must be set for $GAME_NAME}\"  # mandatory\n\n# ----------------------------\n# Locale Setup to suppress warnings\n# ----------------------------\nexport LANG=en_US.UTF-8\nexport LANGUAGE=en_US:en\nexport LC_ALL=en_US.UTF-8\n\n# ----------------------------\n# Logging Setup\n# ----------------------------\nSAFE_NAME=\"${GAME_NAME\/\/ \/_}_install.log\"\nINSTALL_LOG=\"$HOME\/$SAFE_NAME\"\n\n# Initialize log file\n: > \"$INSTALL_LOG\"\n\n# ----------------------------\n# Colors\n# ----------------------------\nRED=$(tput setaf 1 2>\/dev\/null || echo \"\")\nGREEN=$(tput setaf 2 2>\/dev\/null || echo \"\")\nYELLOW=$(tput setaf 3 2>\/dev\/null || echo \"\")\nBLUE=$(tput setaf 4 2>\/dev\/null || echo \"\")\nCYAN=$(tput setaf 6 2>\/dev\/null || echo \"\")\nWHITE=$(tput setaf 7 2>\/dev\/null || echo \"\")\nBOLD=$(tput bold 2>\/dev\/null || echo \"\")\nNC=$(tput sgr0 2>\/dev\/null || echo \"\")\n\nLINE=\"${BLUE}════════════════════════════════════════════════════════════════${NC}\"\n\n# ----------------------------\n# Logging Functions\n# ----------------------------\nlog_info()    { \n    echo \"$(date '+%Y-%m-%d %H:%M:%S') ${BLUE}[INFO]${NC} $*\"\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] $*\" >> \"$INSTALL_LOG\"\n}\nlog_warn()    { \n    echo \"$(date '+%Y-%m-%d %H:%M:%S') ${YELLOW}[WARN]${NC} $*\"\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] $*\" >> \"$INSTALL_LOG\"\n}\nlog_error()   { \n    echo \"$(date '+%Y-%m-%d %H:%M:%S') ${RED}[ERROR]${NC} $*\" >&2\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] $*\" >> \"$INSTALL_LOG\"\n}\nlog_success() { \n    echo \"$(date '+%Y-%m-%d %H:%M:%S') ${GREEN}[ OK ]${NC} $*\"\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [ OK ] $*\" >> \"$INSTALL_LOG\"\n}\n\n# Visual output functions (no timestamps for clean display)\nprint_step()    { \n    echo \"${BLUE}│${NC}  ${CYAN}→${NC} $*\"\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [STEP] $*\" >> \"$INSTALL_LOG\"\n}\nprint_ok()      { \n    echo \"${BLUE}│${NC}  ${GREEN}✓${NC} $*\"\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] $*\" >> \"$INSTALL_LOG\"\n}\nprint_warn()    { \n    echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} $*\"\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] $*\" >> \"$INSTALL_LOG\"\n}\nprint_error()   { \n    echo \"${BLUE}│${NC}  ${RED}✗${NC} $*\" >&2\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] $*\" >> \"$INSTALL_LOG\"\n}\n\n# Centered text in box (width=64 total, 62 between borders)\nprint_centered() {\n    local text=\"$1\"\n    local color=\"$2\"\n    local box_width=62\n    # Remove ANSI codes for length calculation\n    local clean_text=$(printf \"%s\" \"$text\" | sed 's\/\\x1b\\[[0-9;]*m\/\/g')\n    local text_len=${#clean_text}\n    local total_padding=$((box_width - text_len))\n    local left_pad=$((total_padding \/ 2))\n    local right_pad=$((total_padding - left_pad))\n    printf \"${BLUE}║${NC}%*s%s%s%s%*s${BLUE}║${NC}\\n\" \"$left_pad\" \"\" \"$color\" \"$text\" \"${NC}\" \"$right_pad\" \"\"\n}\n\n# Progress indication removed - causes issues with output redirection\n\n# ----------------------------\n# System Check Function\n# ----------------------------\nsystem_check() {\n    local sys_info_file=\"$HOME\/system_info.txt\"\n    \n    echo \"\"\n    echo \"${BLUE}╔════════════════════════════════════════════════════════════════╗${NC}\"\n    # \"SYSTEM INFORMATION CHECK\" = 24 chars, (64-24)\/2 = 20 left, 20 right\n    printf \"${BLUE}║${NC}%20s${CYAN}${BOLD}%s${NC}%20s${BLUE}║${NC}\\n\" \"\" \"SYSTEM INFORMATION CHECK\" \"\"\n    echo \"${BLUE}╚════════════════════════════════════════════════════════════════╝${NC}\"\n    echo \"\"\n    \n    # Initialize system info file\n    {\n        echo \"==================================================================\"\n        echo \"                   SYSTEM INFORMATION CHECK\"\n        echo \"==================================================================\"\n        echo \"Date: $(date '+%Y-%m-%d %H:%M:%S')\"\n        echo \"==================================================================\"\n        echo \"\"\n    } > \"$sys_info_file\"\n    \n    # Kernel Information\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}Kernel Information${NC}\"\n    if command -v uname &> \/dev\/null; then\n        local kernel_name\n        local kernel_version\n        local distro_name=\"Unknown\"\n        local distro_version=\"\"\n        \n        kernel_name=$(uname -s)\n        kernel_version=$(uname -r)\n        \n        # Detect Linux distribution (pure bash, no external tools)\n        if [[ -f \/etc\/os-release ]]; then\n            # Modern standard (systemd-based distros, Alpine, etc.)\n            while IFS='=' read -r key value; do\n                value=\"${value%\\\"}\"\n                value=\"${value#\\\"}\"\n                case \"$key\" in\n                    PRETTY_NAME) distro_name=\"$value\" ;;\n                    VERSION_ID) distro_version=\"$value\" ;;\n                esac\n            done < \/etc\/os-release\n        elif [[ -f \/etc\/lsb-release ]]; then\n            # LSB-compliant distros\n            while IFS='=' read -r key value; do\n                value=\"${value%\\\"}\"\n                value=\"${value#\\\"}\"\n                case \"$key\" in\n                    DISTRIB_DESCRIPTION) distro_name=\"$value\" ;;\n                    DISTRIB_RELEASE) distro_version=\"$value\" ;;\n                esac\n            done < \/etc\/lsb-release\n        elif [[ -f \/etc\/alpine-release ]]; then\n            distro_name=\"Alpine Linux\"\n            distro_version=$(cat \/etc\/alpine-release 2>\/dev\/null)\n        elif [[ -f \/etc\/debian_version ]]; then\n            distro_name=\"Debian\"\n            distro_version=$(cat \/etc\/debian_version 2>\/dev\/null)\n        elif [[ -f \/etc\/redhat-release ]]; then\n            distro_name=$(cat \/etc\/redhat-release 2>\/dev\/null)\n        elif [[ -f \/etc\/arch-release ]]; then\n            distro_name=\"Arch Linux\"\n        elif [[ -f \/etc\/gentoo-release ]]; then\n            distro_name=$(cat \/etc\/gentoo-release 2>\/dev\/null)\n        elif [[ -f \/etc\/SuSE-release ]]; then\n            distro_name=$(head -n1 \/etc\/SuSE-release 2>\/dev\/null)\n        elif [[ -f \/etc\/issue ]]; then\n            # Fallback to \/etc\/issue (strip escape sequences)\n            distro_name=$(head -n1 \/etc\/issue 2>\/dev\/null | sed 's\/\\\\[a-z]\/\/g' | xargs)\n        fi\n        \n        # Fallback if still unknown\n        [[ \"$distro_name\" == \"Unknown\" || -z \"$distro_name\" ]] && distro_name=\"$kernel_name\"\n        \n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Distro:  ${WHITE}${distro_name}${NC}\"\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Kernel:  ${WHITE}${kernel_version}${NC}\"\n        {\n            echo \"KERNEL INFORMATION:\"\n            echo \"  Distro:  ${distro_name}\"\n            echo \"  Kernel:  ${kernel_version}\"\n            echo \"\"\n        } >> \"$sys_info_file\"\n    else\n        echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Kernel information not available\"\n        echo \"Kernel Information: Not available\" >> \"$sys_info_file\"\n        echo \"\" >> \"$sys_info_file\"\n    fi\n    echo \"${BLUE}└─${NC}\"\n    \n    # CPU Information\n    echo \"\"\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}CPU Information${NC}\"\n    if [[ -f \/proc\/cpuinfo ]]; then\n        local cpu_model\n        local cpu_cores\n        cpu_model=$(grep \"model name\" \/proc\/cpuinfo | head -n1 | cut -d':' -f2 | xargs)\n        cpu_cores=$(grep -c \"^processor\" \/proc\/cpuinfo)\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Model:   ${WHITE}${cpu_model}${NC}\"\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Cores:   ${WHITE}${cpu_cores}${NC}\"\n        {\n            echo \"CPU INFORMATION:\"\n            echo \"  Model: ${cpu_model}\"\n            echo \"  Cores: ${cpu_cores}\"\n            echo \"\"\n        } >> \"$sys_info_file\"\n    else\n        echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} CPU information not available\"\n        echo \"CPU Information: Not available\" >> \"$sys_info_file\"\n        echo \"\" >> \"$sys_info_file\"\n    fi\n    echo \"${BLUE}└─${NC}\"\n    \n    # Virtualization Detection\n    echo \"\"\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}Virtualization${NC}\"\n    local virt_status=\"Unknown\"\n    local virt_detail=\"\"\n    \n    if command -v systemd-detect-virt &> \/dev\/null; then\n        virt_status=$(systemd-detect-virt 2>\/dev\/null || echo \"none\")\n        if [[ \"$virt_status\" == \"none\" ]]; then\n            echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Type:    ${GREEN}Bare Metal${NC}\"\n            virt_status=\"Bare Metal\"\n        else\n            # Capitalize first letter for better display\n            virt_detail=\"$virt_status\"\n            case \"$virt_status\" in\n                kvm) virt_detail=\"KVM\" ;;\n                qemu) virt_detail=\"QEMU\" ;;\n                docker) virt_detail=\"Docker Container\" ;;\n                lxc) virt_detail=\"LXC Container\" ;;\n                vmware) virt_detail=\"VMware\" ;;\n                microsoft) virt_detail=\"Hyper-V\" ;;\n                xen) virt_detail=\"Xen\" ;;\n            esac\n            echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Type:    ${YELLOW}${virt_detail}${NC}\"\n        fi\n    elif [[ -f \/proc\/cpuinfo ]]; then\n        if grep -qE \"^flags.*hypervisor\" \/proc\/cpuinfo; then\n            local dmi_vendor=\"\"\n            local dmi_product=\"\"\n            if [[ -r \/sys\/class\/dmi\/id\/sys_vendor ]]; then\n                dmi_vendor=$(tr -d '\\n' <\/sys\/class\/dmi\/id\/sys_vendor 2>\/dev\/null || true)\n            fi\n            if [[ -r \/sys\/class\/dmi\/id\/product_name ]]; then\n                dmi_product=$(tr -d '\\n' <\/sys\/class\/dmi\/id\/product_name 2>\/dev\/null || true)\n            fi\n\n            if [[ -e \/dev\/kvm ]] || grep -qi \"kvm\" \/proc\/cpuinfo; then\n                virt_status=\"KVM\"\n                virt_detail=\"KVM\"\n                echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Type:    ${YELLOW}KVM${NC}\"\n            elif echo \"$dmi_vendor $dmi_product\" | grep -qi \"vmware\"; then\n                virt_status=\"VMware\"\n                virt_detail=\"VMware\"\n                echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Type:    ${YELLOW}VMware${NC}\"\n            elif echo \"$dmi_vendor $dmi_product\" | grep -qi \"microsoft\"; then\n                virt_status=\"Hyper-V\"\n                virt_detail=\"Hyper-V\"\n                echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Type:    ${YELLOW}Hyper-V${NC}\"\n            elif echo \"$dmi_vendor $dmi_product\" | grep -qi \"xen\"; then\n                virt_status=\"Xen\"\n                virt_detail=\"Xen\"\n                echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Type:    ${YELLOW}Xen${NC}\"\n            elif echo \"$dmi_vendor $dmi_product\" | grep -qi \"qemu\"; then\n                virt_status=\"QEMU\"\n                virt_detail=\"QEMU\"\n                echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Type:    ${YELLOW}QEMU${NC}\"\n            else\n                virt_status=\"Virtualized\"\n                virt_detail=\"Hypervisor detected\"\n                echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Type:    ${YELLOW}Virtualized${NC} ${WHITE}(${virt_detail})${NC}\"\n            fi\n        else\n            echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Type:    ${GREEN}Likely Bare Metal${NC}\"\n            virt_status=\"Likely Bare Metal\"\n        fi\n    else\n        echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Type:    ${YELLOW}Cannot determine${NC}\"\n    fi\n    {\n        echo \"VIRTUALIZATION:\"\n        echo \"  Type: ${virt_status}\"\n        echo \"\"\n    } >> \"$sys_info_file\"\n    echo \"${BLUE}└─${NC}\"\n    \n    # Memory (RAM) Information\n    echo \"\"\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}Memory (RAM)${NC}\"\n    if [[ -f \/proc\/meminfo ]]; then\n        local total_ram_kb\n        local total_ram_mb\n        local total_ram_gb\n        local available_ram_kb\n        local available_ram_mb\n        local available_ram_gb\n        local used_ram_mb\n        local ram_percent\n        \n        total_ram_kb=$(grep \"MemTotal\" \/proc\/meminfo | awk '{print $2}')\n        total_ram_mb=$((total_ram_kb \/ 1024))\n        # Pure bash decimal calculation (integer.decimal)\n        total_ram_gb=\"$((total_ram_mb \/ 1024)).$((total_ram_mb * 100 \/ 1024 % 100))\"\n        \n        available_ram_kb=$(grep \"MemAvailable\" \/proc\/meminfo | awk '{print $2}')\n        available_ram_mb=$((available_ram_kb \/ 1024))\n        available_ram_gb=\"$((available_ram_mb \/ 1024)).$((available_ram_mb * 100 \/ 1024 % 100))\"\n        \n        used_ram_mb=$((total_ram_mb - available_ram_mb))\n        # Calculate percentage with one decimal place using pure bash\n        ram_percent=\"$((used_ram_mb * 100 \/ total_ram_mb)).$((used_ram_mb * 1000 \/ total_ram_mb % 10))\"\n        \n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Total:     ${WHITE}${total_ram_mb} MB${NC} ${BLUE}(${WHITE}${total_ram_gb} GB${BLUE})${NC}\"\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Available: ${WHITE}${available_ram_mb} MB${NC} ${BLUE}(${WHITE}${available_ram_gb} GB${BLUE})${NC}\"\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Used:      ${WHITE}${used_ram_mb} MB${NC}\"\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Usage:     ${YELLOW}${ram_percent}%${NC}\"\n        \n        {\n            echo \"MEMORY (RAM):\"\n            echo \"  Total:     ${total_ram_mb} MB (${total_ram_gb} GB)\"\n            echo \"  Available: ${available_ram_mb} MB (${available_ram_gb} GB)\"\n            echo \"  Used:      ${used_ram_mb} MB\"\n            echo \"  Usage:     ${ram_percent}%\"\n            echo \"\"\n        } >> \"$sys_info_file\"\n    else\n        echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Memory information not available\"\n        echo \"Memory (RAM): Not available\" >> \"$sys_info_file\"\n        echo \"\" >> \"$sys_info_file\"\n    fi\n    echo \"${BLUE}└─${NC}\"\n    \n    # Disk Space Information\n    echo \"\"\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}Disk Space (Home Directory)${NC}\"\n    if command -v df &> \/dev\/null; then\n        local disk_info\n        local disk_total\n        local disk_used\n        local disk_available\n        local disk_percent\n        \n        disk_info=$(df -h \"$HOME\" 2>\/dev\/null | tail -n1)\n        disk_total=$(echo \"$disk_info\" | awk '{print $2}')\n        disk_used=$(echo \"$disk_info\" | awk '{print $3}')\n        disk_available=$(echo \"$disk_info\" | awk '{print $4}')\n        disk_percent=$(echo \"$disk_info\" | awk '{print $5}')\n        \n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Total:     ${WHITE}${disk_total}${NC}\"\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Used:      ${WHITE}${disk_used}${NC} ${YELLOW}(${disk_percent})${NC}\"\n        echo \"${BLUE}│${NC}  ${GREEN}✓${NC} Available: ${WHITE}${disk_available}${NC}\"\n        \n        {\n            echo \"DISK SPACE (Home Directory):\"\n            echo \"  Total:     ${disk_total}\"\n            echo \"  Used:      ${disk_used} (${disk_percent})\"\n            echo \"  Available: ${disk_available}\"\n            echo \"\"\n        } >> \"$sys_info_file\"\n    else\n        echo \"${BLUE}│${NC}  ${YELLOW}⚠${NC} Disk information not available\"\n        echo \"Disk Space: Not available\" >> \"$sys_info_file\"\n        echo \"\" >> \"$sys_info_file\"\n    fi\n    echo \"${BLUE}└─${NC}\"\n    \n    echo \"\"\n    {\n        echo \"==================================================================\"\n        echo \"                  END OF SYSTEM INFORMATION\"\n        echo \"==================================================================\"\n    } >> \"$sys_info_file\"\n    \n    # Only log to file, no screen output\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] System information saved to: ${sys_info_file}\" >> \"$INSTALL_LOG\"\n    echo \"\"\n}\n\n# ----------------------------\n# Validation Functions\n# ----------------------------\nvalidate_steam_appid() {\n    if [[ ! \"$STEAM_APPID\" =~ ^[0-9]+$ ]]; then\n        log_error \"STEAM_APPID must be numeric: $STEAM_APPID\"\n        exit 1\n    fi\n}\n\nvalidate_config_url() {\n    # Only validate if CONFIG_INIT is enabled\n    if [[ \"${CONFIG_INIT:-0}\" -eq 1 ]] && [[ -n \"$CONFIG_URL\" ]]; then\n        if [[ ! \"$CONFIG_URL\" =~ ^https?:\/\/[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}(\/.*)?$ ]]; then\n            log_error \"CONFIG_URL must be a valid HTTP\/HTTPS URL: $CONFIG_URL\"\n            exit 1\n        fi\n        \n        # Check for suspicious URLs\n        if [[ \"$CONFIG_URL\" =~ (localhost|127\\.0\\.0\\.1|0\\.0\\.0\\.0|::1) ]]; then\n            log_warn \"CONFIG_URL points to localhost - this may be intentional but could be suspicious\"\n        fi\n    fi\n}\n\n# New function for additional security checks\nvalidate_steam_credentials() {\n    # Check for suspicious characters in Steam credentials\n    local suspicious_chars='[;&|`$()]'\n    \n    if [[ \"$STEAM_USER\" =~ $suspicious_chars ]]; then\n        log_error \"STEAM_USER contains suspicious characters\"\n        exit 1\n    fi\n    \n    if [[ -n \"$STEAM_PASS\" ]] && [[ \"$STEAM_PASS\" =~ $suspicious_chars ]]; then\n        log_error \"STEAM_PASS contains suspicious characters\"\n        exit 1\n    fi\n    \n    if [[ -n \"$STEAM_AUTH\" ]] && [[ \"$STEAM_AUTH\" =~ $suspicious_chars ]]; then\n        log_error \"STEAM_AUTH contains suspicious characters\"\n        exit 1\n    fi\n}\n\nvalidate_path() {\n    local path=\"$1\"\n    local name=\"$2\"\n    \n    # Check for path traversal attempts\n    if [[ \"$path\" =~ \\.\\.\/\\.\\. ]] || [[ \"$path\" =~ ^\/etc ]] || [[ \"$path\" =~ ^\/root ]]; then\n        log_error \"Invalid or dangerous path for $name: $path\"\n        exit 1\n    fi\n    \n    # Ensure path starts with $HOME\n    if [[ ! \"$path\" =~ ^\"$HOME\" ]]; then\n        log_error \"Path $name must start with HOME directory: $path\"\n        exit 1\n    fi\n}\n\ncheck_dependencies() {\n    local deps=(\"curl\" \"tar\")\n    local missing=()\n    local optional_deps=(\"wget\" \"unzip\")\n    \n    # Check if curl supports HTTPS\n    local curl_https_support=false\n    if command -v curl >\/dev\/null 2>&1; then\n        if curl --version 2>\/dev\/null | grep -q \"https\"; then\n            curl_https_support=true\n        else\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] curl found but HTTPS support is missing\" >> \"$INSTALL_LOG\"\n        fi\n    else\n        missing+=(\"curl\")\n    fi\n    \n    for dep in \"${deps[@]}\"; do\n        if ! command -v \"$dep\" >\/dev\/null 2>&1; then\n            missing+=(\"$dep\")\n        fi\n    done\n    \n    # Try to install missing dependencies automatically\n    if [[ \"${#missing[@]}\" -gt 0 ]] || [[ \"$curl_https_support\" == \"false\" ]]; then\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] Attempting to install missing dependencies...\" >> \"$INSTALL_LOG\"\n        \n        # Alpine Linux\n        if command -v apk >\/dev\/null 2>&1; then\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] Detected Alpine Linux, installing packages...\" >> \"$INSTALL_LOG\"\n            apk add --no-cache curl ca-certificates openssl tar wget 2>\/dev\/null || {\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Failed to install packages via apk\" >> \"$INSTALL_LOG\"\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Missing required dependencies: ${missing[*]}\" >> \"$INSTALL_LOG\"\n                print_error \"Failed to install packages via apk\"\n                exit 1\n            }\n        # Debian\/Ubuntu\n        elif command -v apt-get >\/dev\/null 2>&1; then\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] Detected Debian\/Ubuntu, installing packages...\" >> \"$INSTALL_LOG\"\n            export DEBIAN_FRONTEND=noninteractive\n            apt-get update >\/dev\/null 2>&1 || true\n            apt-get install -y curl ca-certificates openssl tar wget gnupg2 2>\/dev\/null || {\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Failed to install packages via apt-get\" >> \"$INSTALL_LOG\"\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Missing required dependencies: ${missing[*]}\" >> \"$INSTALL_LOG\"\n                print_error \"Failed to install packages via apt-get\"\n                exit 1\n            }\n            # Update CA certificates to ensure HTTPS works properly\n            update-ca-certificates >\/dev\/null 2>&1 || true\n        else\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Unsupported Linux distribution\" >> \"$INSTALL_LOG\"\n            print_error \"Unsupported Linux distribution\"\n            exit 1\n        fi\n        \n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] Dependencies installed successfully\" >> \"$INSTALL_LOG\"\n    fi\n    \n    # Re-check dependencies after installation\n    missing=()\n    for dep in \"${deps[@]}\"; do\n        if ! command -v \"$dep\" >\/dev\/null 2>&1; then\n            missing+=(\"$dep\")\n        fi\n    done\n    \n    if [[ \"${#missing[@]}\" -gt 0 ]]; then\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Still missing dependencies after installation: ${missing[*]}\" >> \"$INSTALL_LOG\"\n        print_error \"Still missing dependencies after installation: ${missing[*]}\"\n        exit 1\n    fi\n    \n    # Check optional dependencies\n    for dep in \"${optional_deps[@]}\"; do\n        if ! command -v \"$dep\" >\/dev\/null 2>&1; then\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] Optional dependency missing: $dep\" >> \"$INSTALL_LOG\"\n        fi\n    done\n    \n    # Check system requirements\n    if [[ \"$(nproc 2>\/dev\/null || echo 1)\" -lt 2 ]]; then\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] System has less than 2 CPU cores\" >> \"$INSTALL_LOG\"\n    fi\n    \n    local available_memory\n    available_memory=\"$(awk '\/MemAvailable\/ {print int($2\/1024)}' \/proc\/meminfo 2>\/dev\/null || echo 0)\"\n    if [[ \"$available_memory\" -lt 1024 ]]; then\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] Less than 1GB available memory\" >> \"$INSTALL_LOG\"\n    fi\n    \n    # Only log to file, no screen output\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] All required dependencies found\" >> \"$INSTALL_LOG\"\n}\n\n# ----------------------------\n# Download with Retry Function\n# ----------------------------\n# shellcheck disable=SC2317  # Function is called later in script\ndownload_with_retry() {\n    local url=\"$1\" \n    local output=\"$2\" \n    local retries=\"${3:-3}\"\n    local desc=\"${4:-file}\"\n    local expected_size=\"${5:-}\"\n    \n    # Validate URL format\n    if [[ ! \"$url\" =~ ^https?:\/\/[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}(\/.*)?$ ]]; then\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Invalid URL format: $url\" >> \"$INSTALL_LOG\"\n        return 1\n    fi\n    \n    # Check if HTTPS is supported by curl\n    local curl_supports_https=true\n    if ! curl --version 2>\/dev\/null | grep -q \"https\"; then\n        curl_supports_https=false\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] HTTPS not supported by curl, will try HTTP fallback\" >> \"$INSTALL_LOG\"\n    fi\n    \n    for i in $(seq 1 \"$retries\"); do\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] Downloading $desc (attempt $i\/$retries)...\" >> \"$INSTALL_LOG\"\n        \n        # Determine which URLs to try based on HTTPS support\n        local urls_to_try=()\n        if [[ \"$url\" =~ ^https:\/\/ ]]; then\n            if [[ \"$curl_supports_https\" == \"true\" ]]; then\n                # Try HTTPS first, then HTTP as fallback\n                urls_to_try=(\"$url\" \"${url\/https:\/http:}\")\n            else\n                # Only try HTTP if HTTPS is not supported\n                urls_to_try=(\"${url\/https:\/http:}\")\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] Using HTTP instead of HTTPS: ${url\/https:\/http:}\" >> \"$INSTALL_LOG\"\n            fi\n        else\n            # URL is already HTTP\n            urls_to_try=(\"$url\")\n        fi\n        \n        local success=false\n        local last_error=\"\"\n        \n        for try_url in \"${urls_to_try[@]}\"; do\n            # Use appropriate curl options based on protocol\n            local curl_opts=(\n                -fsSL\n                --connect-timeout 30\n                --max-time 300\n                --retry 1\n                --retry-delay 1\n                --location\n                -H \"User-Agent: GameServer-Installer\/1.0\"\n                -o \"$output\"\n            )\n            \n            # Add protocol restrictions based on URL and support\n            if [[ \"$try_url\" =~ ^https:\/\/ ]]; then\n                curl_opts+=(--proto '=https' --tlsv1.2)\n            else\n                curl_opts+=(--proto '=http')\n            fi\n            \n            last_error=$(curl \"${curl_opts[@]}\" \"$try_url\" 2>&1)\n            if [[ \"$?\" -eq 0 ]]; then\n                success=true\n                break\n            fi\n        done\n        \n        if [[ \"$success\" == \"true\" ]]; then\n            # Verify download\n            if [[ -f \"$output\" ]]; then\n                local file_size\n                file_size=\"$(stat -f%z \"$output\" 2>\/dev\/null || stat -c%s \"$output\" 2>\/dev\/null || echo 0)\"\n                \n                if [[ \"$file_size\" -gt 0 ]]; then\n                    if [[ -n \"$expected_size\" ]] && [[ \"$file_size\" -lt \"$expected_size\" ]]; then\n                        echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] Downloaded file seems too small ($file_size bytes, expected at least $expected_size)\" >> \"$INSTALL_LOG\"\n                    fi\n                    echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] Downloaded $desc successfully ($file_size bytes)\" >> \"$INSTALL_LOG\"\n                    return 0\n                else\n                    echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Downloaded file is empty\" >> \"$INSTALL_LOG\"\n                    rm -f \"$output\"\n                fi\n            fi\n        else\n            if [[ -n \"$last_error\" ]]; then\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] Download failed: $last_error\" >> \"$INSTALL_LOG\"\n            fi\n        fi\n        \n        if [[ \"$i\" -lt \"$retries\" ]]; then\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] Download attempt $i failed, retrying in 5 seconds...\" >> \"$INSTALL_LOG\"\n            sleep 5\n        fi\n    done\n    \n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Failed to download $desc after $retries attempts\" >> \"$INSTALL_LOG\"\n    return 1\n}\n\n# ----------------------------\n# Safe command execution\n# ----------------------------\nrun_or_fail() {\n    local desc=\"$1\"; shift\n    # Only log to file, no screen output\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] Starting: $desc\" >> \"$INSTALL_LOG\"\n    \n    if \"$@\" >> \"$INSTALL_LOG\" 2>&1; then\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] $desc\" >> \"$INSTALL_LOG\"\n    else\n        local exit_code=$?\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] $desc failed with exit code $exit_code\" >> \"$INSTALL_LOG\"\n        print_error \"$desc failed (exit code $exit_code)\"\n        exit 1\n    fi\n}\n\n# ----------------------------\n# Library Copy Helper\n# ----------------------------\ncopy_game_libs() {\n    local items=()\n    if [[ \"$#\" -gt 0 ]]; then\n        items=(\"$@\");\n    else\n        items=(\"${LIB_COPY_ITEMS[@]}\")\n    fi\n\n    if [[ \"${#items[@]}\" -eq 0 ]]; then\n        return 0\n    fi\n\n    print_step \"Copying libraries...\"\n    \n    local item src dest\n    for item in \"${items[@]}\"; do\n        IFS='|' read -r src dest <<< \"$item\"\n\n        if [[ -z \"${src:-}\" || -z \"${dest:-}\" ]]; then\n            print_warn \"Invalid copy entry (expected 'src|dest'): $item\"\n            continue\n        fi\n\n        if [[ ! -e \"$src\" ]]; then\n            print_error \"Source not found: $src\"\n            continue\n        fi\n\n        mkdir -p \"$(dirname \"$dest\")\"\n\n        if [[ -d \"$src\" ]]; then\n            if cp -a \"$src\" \"$dest\" >\/dev\/null 2>&1; then\n                print_ok \"Copied directory: $src -> $dest\"\n            else\n                print_warn \"Failed to copy directory: $src -> $dest\"\n            fi\n        else\n            if cp -f \"$src\" \"$dest\" >\/dev\/null 2>&1; then\n                print_ok \"Copied file: $src -> $dest\"\n            else\n                print_warn \"Failed to copy file: $src -> $dest\"\n            fi\n        fi\n    done\n}\n\n# ----------------------------\n# Cleanup Function\n# ----------------------------\ncleanup() {\n    local exit_code=$?\n    \n    # Remove temporary files silently\n    rm -f \/tmp\/steamcmd.tar.gz \/tmp\/depotdownloader.zip \/tmp\/steam_output.log 2>\/dev\/null || true\n    \n    # Clean up any leftover processes\n    pkill -f \"steamcmd\" 2>\/dev\/null || true\n    pkill -f \"DepotDownloader\" 2>\/dev\/null || true\n    \n    # Clear sensitive variables\n    unset STEAM_PASS STEAM_AUTH\n    \n    exit \"$exit_code\"\n}\n\ntrap cleanup EXIT\n\n# ----------------------------\n# Secure Steam Command Execution\n# ----------------------------\nrun_steam_command() {\n    local -a cmd_array=()\n    local desc=\"$2\"\n    \n    # Parse command array from first argument\n    eval \"cmd_array=($1)\"\n    \n    echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] Executing: $desc\" >> \"$INSTALL_LOG\"\n    \n    local temp_output=\"\/tmp\/steam_output_$$.log\"\n    local exit_code=0\n    \n    # Execute command and process output in real-time\n    echo \"${BLUE}│${NC}\"\n    \"${cmd_array[@]}\" 2>&1 | while IFS= read -r line; do\n        # Save raw line to temp file\n        echo \"$line\" >> \"$temp_output\"\n        \n        # Remove ANSI escape codes for cleaner logging\n        local clean_line\n        clean_line=$(echo \"$line\" | sed -r 's\/\\x1b\\[[0-9;]*[mK]\/\/g' | sed 's\/(B\\[m\/\/g')\n        \n        # Skip banner messages, license info, and other non-error messages\n        if [[ \"$clean_line\" =~ (Image by gOOvER|discord.goover.dev|LICENSED UNDER|Redirecting stderr) ]] || \\\n           [[ \"$clean_line\" =~ ^[[:space:]]*$ ]]; then\n            continue\n        fi\n        \n        # Log relevant lines (filtered) to file\n        if ! echo \"$clean_line\" | grep -qiE \"password|auth|token|secret\"; then\n            # Only log errors, warnings, progress, and important messages\n            if [[ \"$clean_line\" =~ (ERROR|Failed|Warning|Success|Update|Downloading|Validating|progress|Installing|Loading) ]] || \\\n               [[ \"$clean_line\" =~ ^\\ *\\[.*\\] ]] || \\\n               [[ \"$clean_line\" =~ \"Depot download\" ]] || \\\n               [[ \"$clean_line\" =~ \"Connecting\" ]] || \\\n               [[ \"$clean_line\" =~ \"Waiting\" ]] || \\\n               [[ \"$clean_line\" =~ \"App\" ]] || \\\n               [[ \"$clean_line\" =~ \"state\" ]]; then\n                echo \"$clean_line\" >> \"$INSTALL_LOG\" 2>\/dev\/null || true\n            fi\n        fi\n        \n        # Show progress lines on screen (update%, downloading, validating, installing)\n        if [[ \"$clean_line\" =~ (Update|Downloading|Validating|Installing|Loading|progress|state|[0-9]+%) ]] || \\\n           [[ \"$clean_line\" =~ ^\\ *\\[.*\\] ]] || \\\n           [[ \"$clean_line\" =~ \"Success\" ]] || \\\n           [[ \"$clean_line\" =~ \"Depot download\" ]] || \\\n           [[ \"$clean_line\" =~ \"App.*[0-9]+\" ]]; then\n            # Filter out sensitive information before display\n            if ! echo \"$clean_line\" | grep -qiE \"password|auth|token|secret|login\"; then\n                printf \"${BLUE}│${NC}  ${WHITE}%s${NC}\\n\" \"$clean_line\"\n            fi\n        fi\n    done\n    \n    # Capture exit code from the command, not the while loop\n    exit_code=\"${PIPESTATUS[0]}\"\n    \n    # Clean up temporary file\n    rm -f \"$temp_output\"\n    echo \"${BLUE}│${NC}\"\n    \n    # Check for specific error messages in log\n    local last_error=\"\"\n    if [[ -f \"$INSTALL_LOG\" ]]; then\n        last_error=$(tail -n 20 \"$INSTALL_LOG\" | { grep -i \"ERROR\\|Failed\" || true; } | tail -n 1)\n    fi\n    \n    # Log results and handle errors\n    case \"$exit_code\" in\n        0) \n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [OK] $desc completed successfully\" >> \"$INSTALL_LOG\"\n            return 0\n            ;;\n        2) \n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Steam login failed - check credentials\" >> \"$INSTALL_LOG\"\n            print_error \"Steam login failed\"\n            exit 1\n            ;;\n        5) \n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] App not found or access denied for AppID: $STEAM_APPID\" >> \"$INSTALL_LOG\"\n            print_error \"App not found (AppID: $STEAM_APPID)\"\n            exit 1\n            ;;\n        7) \n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Steam is updating, please try again later\" >> \"$INSTALL_LOG\"\n            print_error \"Steam is updating\"\n            exit 1\n            ;;\n        8)\n            echo \"$(date '+%Y-%m-%d %H:%M:%S') [ERROR] Installation failed for AppID: $STEAM_APPID\" >> \"$INSTALL_LOG\"\n            print_error \"Installation failed (AppID: $STEAM_APPID)\"\n            \n            # Check for \"Missing configuration\" error\n            if echo \"$last_error\" | grep -qi \"Missing configuration\"; then\n                echo \"${BLUE}│${NC}\"\n                print_warn \"Possible causes for 'Missing configuration' error:\"\n                echo \"${BLUE}│${NC}    ${YELLOW}1.${NC} App may require a beta branch (set STEAM_BETAID)\"\n                echo \"${BLUE}│${NC}    ${YELLOW}2.${NC} App may be Windows-only (set WINDOWS_INSTALL=1)\"\n                echo \"${BLUE}│${NC}    ${YELLOW}3.${NC} App may require additional install flags\"\n                echo \"${BLUE}│${NC}    ${YELLOW}4.${NC} App ID might be incorrect or not accessible\"\n                echo \"${BLUE}│${NC}    ${YELLOW}5.${NC} App may not have a dedicated server version\"\n                echo \"${BLUE}│${NC}\"\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] Missing configuration error - check egg variables\" >> \"$INSTALL_LOG\"\n            fi\n            exit 1\n            ;;\n        *) \n            if [[ \"$exit_code\" -ne 0 ]]; then\n                echo \"$(date '+%Y-%m-%d %H:%M:%S') [WARN] $desc exited with code $exit_code\" >> \"$INSTALL_LOG\"\n                print_warn \"$desc exited with code $exit_code\"\n                exit 1\n            fi\n            ;;\n    esac\n}\n\n# ----------------------------\n# Start Script Output\n# ----------------------------\nclear\necho \"\"\necho \"${BLUE}╔════════════════════════════════════════════════════════════════╗${NC}\"\n# \"GAME INSTALLATION\" = 17 chars, (64-17)\/2 = 23 left, 24 right\nprintf \"${BLUE}║${NC}%23s${YELLOW}${BOLD}%s${NC}%24s${BLUE}║${NC}\\n\" \"\" \"GAME INSTALLATION\" \"\"\n# \"${GAME_NAME}\" - dynamisch berechnet\ngame_name_len=${#GAME_NAME}\ngame_left=$(( (64 - game_name_len) \/ 2 ))\ngame_right=$(( 64 - game_name_len - game_left ))\nprintf \"${BLUE}║${NC}%*s${WHITE}%s${NC}%*s${BLUE}║${NC}\\n\" \"$game_left\" \"\" \"${GAME_NAME}\" \"$game_right\" \"\"\necho \"${BLUE}╚════════════════════════════════════════════════════════════════╝${NC}\"\necho \"\"\n\n# ----------------------------\n# System Check\n# ----------------------------\nsystem_check\n\n# ----------------------------\n# Pre-flight Checks\n# ----------------------------\necho \"\"\necho \"${BLUE}┌─ ${CYAN}${BOLD}Pre-flight Checks${NC}\"\nprint_step \"Validating environment...\"\ncheck_dependencies\nprint_step \"Validating Steam App ID...\"\nvalidate_steam_appid\nprint_step \"Validating configuration...\"\nvalidate_config_url\nprint_step \"Validating Steam credentials...\"\nvalidate_steam_credentials\nprint_step \"Validating paths...\"\nif [[ \"${CONFIG_INIT:-0}\" -eq 1 ]]; then\n    validate_path \"$CONFIG_DIR\" \"CONFIG_DIR\"\nfi\nvalidate_path \"$STEAMCMD_DIR\" \"STEAMCMD_DIR\"\nprint_ok \"All checks passed\"\necho \"${BLUE}└─${NC}\"\n\n# Check network connectivity\necho \"\"\necho \"${BLUE}┌─ ${CYAN}${BOLD}Network Connectivity${NC}\"\nif ! curl -s --connect-timeout 10 --max-time 15 \"https:\/\/steamcdn-a.akamaihd.net\" >\/dev\/null 2>&1; then\n    print_warn \"HTTPS failed, trying HTTP...\"\n    if ! curl -s --connect-timeout 10 --max-time 15 \"http:\/\/steamcdn-a.akamaihd.net\" >\/dev\/null 2>&1; then\n        print_error \"Cannot reach Steam servers\"\n        echo \"${BLUE}└─${NC}\"\n        exit 1\n    else\n        print_ok \"HTTP connection verified\"\n    fi\nelse\n    print_ok \"HTTPS connection verified\"\nfi\necho \"${BLUE}└─${NC}\"\n\necho \"\"\nif [[ \"$STEAM_USER\" == \"anonymous\" ]]; then\n    echo \"${BLUE}•${NC} ${YELLOW}Using anonymous Steam login${NC}\"\nelse\n    echo \"${BLUE}•${NC} ${CYAN}Steam user:${NC} ${WHITE}$STEAM_USER${NC}\"\nfi\n\n# ----------------------------\n# Game Installation via DepotDownloader\n# ----------------------------\nif [[ \"$DEPOTDOWNLOADER\" == \"1\" ]]; then\n    echo \"\"\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}Game Installation (DepotDownloader)${NC}\"\n    print_step \"Installing $GAME_NAME...\"\n    mkdir -p \"$HOME\/depotdownloader\"\n    cd \"$HOME\/depotdownloader\"\n\n    if [[ ! -f DepotDownloader ]]; then\n        echo \"$(date '+%Y-%m-%d %H:%M:%S') [INFO] Fetching DepotDownloader Linux binary...\" >> \"$INSTALL_LOG\"\n        run_or_fail \"Download DepotDownloader\" \\\n            download_with_retry \\\n            \"https:\/\/github.com\/SteamRE\/DepotDownloader\/releases\/latest\/download\/DepotDownloader-Linux-x64\" \\\n            \"DepotDownloader\" \\\n            3 \\\n            \"DepotDownloader binary\"\n        \n        run_or_fail \"Make DepotDownloader executable\" chmod +x DepotDownloader\n    fi\n\n    # Build DepotDownloader command array\n    declare -a dd_cmd=(\n        \".\/DepotDownloader\"\n        \"-app\" \"$STEAM_APPID\"\n        \"-dir\" \"$HOME\"\n    )\n    \n    if [[ -n \"${STEAM_BETAID:-}\" ]]; then\n        dd_cmd+=(\"-beta\" \"$STEAM_BETAID\")\n    fi\n    \n    if [[ -n \"${STEAM_BETAPASS:-}\" ]]; then\n        dd_cmd+=(\"-betapassword\" \"$STEAM_BETAPASS\")\n    fi\n    \n    # Add install flags if provided\n    if [[ -n \"${INSTALL_FLAGS:-}\" ]]; then\n        read -ra flags <<< \"$INSTALL_FLAGS\"\n        dd_cmd+=(\"${flags[@]}\")\n    fi\n    \n    dd_cmd+=(\"-username\" \"$STEAM_USER\")\n    \n    if [[ -n \"$STEAM_PASS\" ]]; then\n        dd_cmd+=(\"-password\" \"$STEAM_PASS\")\n    fi\n    \n    if [[ -n \"$STEAM_AUTH\" ]]; then\n        dd_cmd+=(\"-remember-password\" \"$STEAM_AUTH\")\n    fi\n\n    # Convert array to string for run_steam_command\n    cmd_string=\"\"\n    printf -v cmd_string '%q ' \"${dd_cmd[@]}\"\n    \n    run_steam_command \"$cmd_string\" \"DepotDownloader installation\"\n    print_ok \"Installation finished\"\n    echo \"${BLUE}└─${NC}\"\nfi\n\n# ----------------------------\n# Game Installation via SteamCMD\n# ----------------------------\nif [[ \"$DEPOTDOWNLOADER\" != \"1\" ]]; then\n    echo \"\"\n    echo \"${BLUE}┌─ ${CYAN}${BOLD}Game Installation (SteamCMD)${NC}\"\n    mkdir -p \"$STEAMCMD_DIR\" \"$HOME\/steamapps\"\n\n    print_step \"Downloading SteamCMD...\"\n    if download_with_retry \\\n        \"http:\/\/steamcdn-a.akamaihd.net\/client\/installer\/steamcmd_linux.tar.gz\" \\\n        \"\/tmp\/steamcmd.tar.gz\" \\\n        3 \\\n        \"SteamCMD archive\"; then\n        print_ok \"SteamCMD downloaded\"\n    else\n        print_error \"Failed to download SteamCMD\"\n        exit 1\n    fi\n    \n    print_step \"Extracting SteamCMD...\"\n    if tar -xzf \/tmp\/steamcmd.tar.gz -C \"$STEAMCMD_DIR\" >> \"$INSTALL_LOG\" 2>&1; then\n        print_ok \"SteamCMD extracted\"\n    else\n        print_error \"Failed to extract SteamCMD\"\n        exit 1\n    fi\n\n    print_step \"Installing $GAME_NAME...\"\n    cd \"$STEAMCMD_DIR\"\n\n    # Build SteamCMD command array\n    declare -a steam_cmd=(\n        \".\/steamcmd.sh\"\n        \"+force_install_dir\" \"$HOME\"\n        \"+login\" \"$STEAM_USER\"\n    )\n    \n    if [[ -n \"$STEAM_PASS\" ]]; then\n        steam_cmd+=(\"$STEAM_PASS\")\n    fi\n    \n    if [[ -n \"$STEAM_AUTH\" ]]; then\n        steam_cmd+=(\"$STEAM_AUTH\")\n    fi\n    \n    if [[ \"${WINDOWS_INSTALL:-0}\" == \"1\" ]]; then\n        steam_cmd+=(\"+@sSteamCmdForcePlatformType\" \"windows\")\n    fi\n    \n    # Build app_update command with all its parameters\n    steam_cmd+=(\"+app_update\" \"$STEAM_APPID\")\n    \n    # Beta parameters must come immediately after app_update, before validate\n    if [[ -n \"${STEAM_BETAID:-}\" ]]; then\n        steam_cmd+=(\"-beta\" \"$STEAM_BETAID\")\n    fi\n    \n    if [[ -n \"${STEAM_BETAPASS:-}\" ]]; then\n        steam_cmd+=(\"-betapassword\" \"$STEAM_BETAPASS\")\n    fi\n    \n    # Add install flags if provided (before validate)\n    if [[ -n \"${INSTALL_FLAGS:-}\" ]]; then\n        read -ra flags <<< \"$INSTALL_FLAGS\"\n        steam_cmd+=(\"${flags[@]}\")\n    fi\n    \n    # validate must be part of the app_update command\n    steam_cmd+=(\"validate\")\n    \n    # Install Steam Linux Runtime (SteamCMD bootstrapping)\n    steam_cmd+=(\"+app_update\" \"1007\" \"validate\")\n    \n    steam_cmd+=(\"+quit\")\n\n    # Convert array to string for run_steam_command\n    cmd_string=\"\"\n    printf -v cmd_string '%q ' \"${steam_cmd[@]}\"\n    \n    run_steam_command \"$cmd_string\" \"SteamCMD installation\"\n    print_ok \"Installation finished\"\n    echo \"${BLUE}└─${NC}\"\nfi\n\n# ----------------------------\n# Steam Libraries Setup\n# ----------------------------\necho \"\"\necho \"${BLUE}┌─ ${CYAN}${BOLD}Steam Libraries Setup${NC}\"\nmkdir -p \"$HOME\/.steam\/sdk32\" \"$HOME\/.steam\/sdk64\"\n\nif [[ -f \"$STEAMCMD_DIR\/linux32\/steamclient.so\" ]]; then\n    if cp -v \"$STEAMCMD_DIR\/linux32\/steamclient.so\" \"$HOME\/.steam\/sdk32\/steamclient.so\" >\/dev\/null 2>&1; then\n        print_ok \"32-bit Steam library copied\"\n    else\n        print_warn \"Failed to copy 32-bit library\"\n    fi\nelse\n    print_warn \"32-bit Steam library not found\"\nfi\n\nif [[ -f \"$STEAMCMD_DIR\/linux64\/steamclient.so\" ]]; then\n    if cp -v \"$STEAMCMD_DIR\/linux64\/steamclient.so\" \"$HOME\/.steam\/sdk64\/steamclient.so\" >\/dev\/null 2>&1; then\n        print_ok \"64-bit Steam library copied\"\n    else\n        print_warn \"Failed to copy 64-bit library\"\n    fi\nelse\n    print_warn \"64-bit library not found\"\nfi\nprint_ok \"Setup complete\"\necho \"${BLUE}└─${NC}\"\n\n# ----------------------------\n# Game-specific Hooks\n# ----------------------------\necho \"\"\necho \"${BLUE}┌─ ${CYAN}${BOLD}Game-specific Hooks${NC}\"\nprint_step \"Executing custom commands...\"\n# <--- add game-specific commands here\ncopy_game_libs\n\n# Create steam_appid.txt if SteamAppId is set\nif [[ -n \"${SteamAppId:-}\" ]]; then\n    echo \"$SteamAppId\" > \"$HOME\/steam_appid.txt\"\n    print_ok \"Created steam_appid.txt with Client AppID: $SteamAppId\"\nfi\n\nprint_ok \"Hooks completed\"\necho \"${BLUE}└─${NC}\"\n\n# ----------------------------\n# Config Setup\n# ----------------------------\necho \"\"\necho \"${BLUE}┌─ ${CYAN}${BOLD}Configuration Setup${NC}\"\nif [[ \"${CONFIG_INIT:-0}\" -eq 1 ]]; then\n    if [[ -f \"$CONFIG_DIR\/$CONFIG_FILE_NAME\" ]]; then\n        print_ok \"$CONFIG_FILE_NAME found\"\n    else\n        print_warn \"$CONFIG_FILE_NAME not found, fetching default...\"\n        mkdir -p \"$CONFIG_DIR\"\n        \n        run_or_fail \"Download default $CONFIG_FILE_NAME\" \\\n            download_with_retry \\\n            \"$CONFIG_URL\" \\\n            \"$CONFIG_DIR\/$CONFIG_FILE_NAME\" \\\n            3 \\\n            \"config file\"\n        print_ok \"Configuration downloaded\"\n    fi\nelse\n    print_step \"Skipping (CONFIG_INIT != 1)\"\nfi\necho \"${BLUE}└─${NC}\"\n\n# ----------------------------\n# Final Verification\n# ----------------------------\necho \"\"\necho \"${BLUE}┌─ ${CYAN}${BOLD}Post-Installation Verification${NC}\"\n\n# Check if Steam libraries were installed correctly\nif [[ ! -d \"$HOME\/.steam\" ]]; then\n    print_warn \"Steam directory not found\"\nfi\n\n# Check if basic Steam files exist\nsteam_files_found=0\nif [[ -f \"$HOME\/.steam\/sdk32\/steamclient.so\" ]]; then\n    steam_files_found=$((steam_files_found + 1))\nfi\nif [[ -f \"$HOME\/.steam\/sdk64\/steamclient.so\" ]]; then\n    steam_files_found=$((steam_files_found + 1))\nfi\n\nif [[ \"$steam_files_found\" -eq 0 ]]; then\n    print_warn \"No Steam libraries found\"\nelif [[ \"$steam_files_found\" -eq 1 ]]; then\n    print_warn \"Only one Steam library found\"\nelse\n    print_ok \"Steam libraries installed\"\nfi\n\n# Check if game files were downloaded (safe version)\ngame_files=0\nif command -v find >\/dev\/null 2>&1; then\n    game_files=\"$(find \"$HOME\" -maxdepth 3 -type f \\( -name \"*.exe\" -o -name \"*.so\" -o -name \"*.bin\" \\) 2>\/dev\/null | wc -l || echo 0)\"\nfi\n\nif [[ \"$game_files\" -gt 0 ]]; then\n    print_ok \"Found $game_files game files\"\nelse\n    print_warn \"No executable files found\"\nfi\n\n# Check permissions (non-fatal)\nif [[ ! -w \"$HOME\" ]]; then\n    print_warn \"HOME directory not writable\"\nelse\n    print_ok \"Permissions correct\"\nfi\n\n# Check if SteamCMD was extracted successfully\nif [[ -f \"$STEAMCMD_DIR\/steamcmd.sh\" ]]; then\n    print_ok \"SteamCMD extracted successfully\"\nelse\n    print_warn \"SteamCMD not found\"\nfi\nprint_ok \"Verification completed\"\necho \"${BLUE}└─${NC}\"\n\n# ----------------------------\n# Cleanup\n# ----------------------------\necho \"\"\necho \"${BLUE}┌─ ${CYAN}${BOLD}Cleanup${NC}\"\nprint_step \"Removing temporary files...\"\nrm -f \/tmp\/steamcmd.tar.gz \/tmp\/depotdownloader.zip \/tmp\/steam_output.log\nprint_ok \"Cleanup complete\"\necho \"${BLUE}└─${NC}\"\n\n# ----------------------------\n# Done\n# ----------------------------\necho \"\"\necho \"${BLUE}╔════════════════════════════════════════════════════════════════╗${NC}\"\n# \"INSTALLATION COMPLETED\" = 22 chars, (64-22)\/2 = 21 left, 21 right\nprintf \"${BLUE}║${NC}%21s${GREEN}${BOLD}%s${NC}%21s${BLUE}║${NC}\\n\" \"\" \"INSTALLATION COMPLETED\" \"\"\necho \"${BLUE}╠════════════════════════════════════════════════════════════════╣${NC}\"\n# Ohne Emojis - nur ASCII für zuverlässige Ausrichtung\n# Zeile 1: \"  [OK] \" = 7 Zeichen, Rest = 57\nprintf \"${BLUE}║${NC}  ${GREEN}[OK]${NC} %-57s${BLUE}║${NC}\\n\" \"${GAME_NAME} successfully installed\"\n# Zeile 2: \"  Log: \" = 7 Zeichen, Rest = 57\nprintf \"${BLUE}║${NC}  Log: %-57s${BLUE}║${NC}\\n\" \"$INSTALL_LOG\"\n# Zeile 3: \"  Support: \" = 11 Zeichen, Rest = 53\nprintf \"${BLUE}║${NC}  Support: %-53s${BLUE}║${NC}\\n\" \"https:\/\/donate.goover.dev\"\necho \"${BLUE}╚════════════════════════════════════════════════════════════════╝${NC}\"\necho \"\"\n\nexit 0",
            "container": "ghcr.io\/goover\/installers:debian",
            "entrypoint": "bash"
        }
    },
    "variables": [
        {
            "name": "AUTO_UPDATE",
            "description": "",
            "env_variable": "AUTO_UPDATE",
            "default_value": "1",
            "user_viewable": true,
            "user_editable": true,
            "rules": "boolean",
            "field_type": "text"
        },
        {
            "name": "LD_LIBRARY_PATH",
            "description": "",
            "env_variable": "LD_LIBRARY_PATH",
            "default_value": ".\/linux64",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|string",
            "field_type": "text"
        },
        {
            "name": "MASTER_PORT",
            "description": "",
            "env_variable": "MASTER_PORT",
            "default_value": "",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string",
            "field_type": "text"
        },
        {
            "name": "SERVER_BACKUPS_ENABLED",
            "description": "Enables rotating backups.",
            "env_variable": "SERVER_BACKUPS_ENABLED",
            "default_value": "true",
            "user_viewable": true,
            "user_editable": true,
            "rules": "in:true,false|required|string",
            "field_type": "text"
        },
        {
            "name": "SERVER_BACKUPS_FREQUENCY",
            "description": "Create a backup every N minutes.",
            "env_variable": "SERVER_BACKUPS_FREQUENCY",
            "default_value": "30",
            "user_viewable": true,
            "user_editable": true,
            "rules": "integer",
            "field_type": "text"
        },
        {
            "name": "SERVER_DATA",
            "description": "",
            "env_variable": "SERVER_DATA",
            "default_value": ".\/GameData\/",
            "user_viewable": true,
            "user_editable": true,
            "rules": "string|required",
            "field_type": "text"
        },
        {
            "name": "LOGS_DIR",
            "description": "",
            "env_variable": "SERVER_LOGS",
            "default_value": ".\/logs\/",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|string",
            "field_type": "text"
        },
        {
            "name": "SERVER_MAX_BACKUPS",
            "description": "Number of backups to keep.",
            "env_variable": "SERVER_MAX_BACKUPS",
            "default_value": "5",
            "user_viewable": true,
            "user_editable": true,
            "rules": "integer",
            "field_type": "text"
        },
        {
            "name": "SERVER_NAME",
            "description": "The name shown in the server browser.",
            "env_variable": "SERVER_NAME",
            "default_value": "New Elysium Server",
            "user_viewable": true,
            "user_editable": true,
            "rules": "string|required",
            "field_type": "text"
        },
        {
            "name": "SERVER_PASSWORD",
            "description": "Password to join. Leave empty for public access.",
            "env_variable": "SERVER_PASSWORD",
            "default_value": "",
            "user_viewable": true,
            "user_editable": true,
            "rules": "string|nullable",
            "field_type": "text"
        },
        {
            "name": "SERVER_PROFILE",
            "description": "Debug profiling (Keep false for performance).",
            "env_variable": "SERVER_PROFILE",
            "default_value": "true",
            "user_viewable": true,
            "user_editable": true,
            "rules": "in:true,false|required|string",
            "field_type": "text"
        },
        {
            "name": "SERVER_SAVE_FREQUENCY",
            "description": "Autosave interval in minutes.",
            "env_variable": "SERVER_SAVE_FREQUENCY",
            "default_value": "5",
            "user_viewable": true,
            "user_editable": true,
            "rules": "string",
            "field_type": "text"
        },
        {
            "name": "SERVER_WORLD",
            "description": "",
            "env_variable": "SERVER_WORLD",
            "default_value": ".\/world\/",
            "user_viewable": true,
            "user_editable": true,
            "rules": "string|required",
            "field_type": "text"
        },
        {
            "name": "STEAM_APPID",
            "description": "",
            "env_variable": "STEAM_APPID",
            "default_value": "2915100",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|in:2915100",
            "field_type": "text"
        },
        {
            "name": "STEAM_BETAID",
            "description": "Use \"public\" for stable, \"beta\" for experimental branches.",
            "env_variable": "STEAM_BETAID",
            "default_value": "public",
            "user_viewable": true,
            "user_editable": true,
            "rules": "string",
            "field_type": "text"
        },
        {
            "name": "SteamAppId",
            "description": "",
            "env_variable": "SteamAppId",
            "default_value": "2644050",
            "user_viewable": false,
            "user_editable": false,
            "rules": "required|string",
            "field_type": "text"
        }
    ]
}