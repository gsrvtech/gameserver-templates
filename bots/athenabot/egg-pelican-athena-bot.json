{
    "_comment": "DO NOT EDIT: FILE GENERATED AUTOMATICALLY BY PANEL",
    "meta": {
        "version": "PLCN_v3",
        "update_url": "https://raw.githubusercontent.com/gsrvtech/gameserver-templates/refs/heads/main/bots/athenabot/egg-pelican-athena-bot.json"
    },
    "exported_at": "2025-12-29T14:14:42+00:00",
    "name": "Athena Bot",
    "author": "eggs@goover.dev",
    "uuid": "bddb292c-2b83-4fc2-9c5f-7070190ca71e",
    "description": "Egg for Lynx Athena Bot",
    "image": null,
    "tags": [
        "discord.js",
        "bot",
        "nodejs"
    ],
    "features": [],
    "docker_images": {
        "ghcr.io/goover/bots:nodemongo7": "ghcr.io/goover/bots:nodemongo7",
        "ghcr.io/goover/bots:nodemongo8": "ghcr.io/goover/bots:nodemongo8",
        "ghcr.io/goover/bots:nodemongo": "ghcr.io/goover/bots:nodemongo"
    },
    "file_denylist": [],
    "startup_commands": {
        "Default": "if [ -f /home/container/package.json ]; then npm install; fi; node /home/container/{{JS_FILE}}",
        "Clear dashboard": "npm run clear_dashboard"
    },
    "config": {
        "files": "{}",
        "startup": "{\n    \"done\": \"AthenaBot is up and running.\"\n}",
        "logs": "{}",
        "stop": "^C"
    },
    "scripts": {
        "installation": {
            "script": "#!/bin/bash\r\n# THIS EGG IS LICENSED UNDER AGPLv3\r\n\r\nset -euo pipefail\r\nIFS=$'\\n\\t'\r\n\r\n# --- Non-interactive for apt ---\r\nexport DEBIAN_FRONTEND=noninteractive\r\n\r\n# --- Define App Name ---\r\nAPPNAME=\"AthenaBot\"\r\n\r\n# --- Colors ---\r\nRED=$(tput setaf 1)\r\nGREEN=$(tput setaf 2)\r\nYELLOW=$(tput setaf 3)\r\nBLUE=$(tput setaf 4)\r\nNC=$(tput sgr0)\r\n\r\n# --- Line separator ---\r\nLINE=\"${BLUE}-------------------------------------------------${NC}\"\r\n\r\n# --- Logging functions ---\r\nlog_info()    { echo \"${BLUE}[INFO]${NC} $*\"; }\r\nlog_warn()    { echo \"${YELLOW}[WARN]${NC} $*\"; }\r\nlog_error()   { echo \"${RED}[ERROR]${NC} $*\" >&2; }\r\nlog_success() { echo \"${GREEN}[ OK ]${NC} $*\"; }\r\n\r\n# --- Helper for running commands safely ---\r\nrun_or_fail() {\r\n    local desc=\"$1\"; shift\r\n    if \"$@\"; then\r\n        log_success \"$desc\"\r\n    else\r\n        log_error \"$desc failed!\"\r\n        exit 1\r\n    fi\r\n}\r\n\r\n# --- Print header ---\r\nprint_header() {\r\n    echo -e \"$LINE\"\r\n    echo -e \"${YELLOW}${APPNAME} Installscript${NC}\"\r\n    echo -e \"${YELLOW}Egg by gOOvER (https://discord.goover.dev) | License: AGPLv3${NC}\"\r\n    echo -e \"$LINE\"\r\n}\r\n\r\nprint_header\r\n\r\n# --- Ensure base folder ---\r\nrun_or_fail \"Create /mnt/server\" mkdir -p /mnt/server\r\ncd /mnt/server || exit 1\r\n\r\n# --- Install dependencies ---\r\necho -e \"$LINE\"\r\nlog_info \"Installing dependencies...\"\r\necho -e \"$LINE\"\r\nrun_or_fail \"apt-get update\" apt-get update -yqq\r\nrun_or_fail \"Install required packages\" apt-get install -yqq build-essential libtool python3 git tar\r\nrun_or_fail \"Clean up apt cache\" bash -c \"apt-get clean && rm -rf /var/lib/apt/lists/*\"\r\n\r\n# --- Update npm ---\r\necho -e \"$LINE\"\r\nlog_info \"Updating npm to latest...\"\r\necho -e \"$LINE\"\r\nrun_or_fail \"npm install -g npm@latest\" npm install -g --force npm@latest\r\nlog_success \"npm version: $(npm --version)\"\r\n\r\n# --- Backup MongoDB if exists ---\r\nREINSTALL=false\r\nif [ -d \"/mnt/server/mongodb\" ]; then\r\n    echo -e \"$LINE\"\r\n    log_info \"Backing up existing MongoDB directory...\"\r\n    echo -e \"$LINE\"\r\n    run_or_fail \"Create MongoDB backup\" tar --exclude='*.tar.gz' -czf /tmp/mongodb_backup.tar.gz mongodb/\r\n    log_info \"MongoDB backup size: $(du -h /tmp/mongodb_backup.tar.gz | cut -f1)\"\r\n    REINSTALL=true\r\nfi\r\n\r\n# --- Install Node.js packages ---\r\nif [ -f package-lock.json ]; then\r\n    echo -e \"$LINE\"\r\n    log_info \"Installing Node.js dependencies (npm ci)...\"\r\n    echo -e \"$LINE\"\r\n    run_or_fail \"npm ci\" npm ci --only=production\r\nelif [ -f package.json ]; then\r\n    echo -e \"$LINE\"\r\n    log_info \"Installing Node.js dependencies (npm install)...\"\r\n    echo -e \"$LINE\"\r\n    run_or_fail \"npm install\" npm install --production\r\nelse\r\n    log_warn \"No package.json found, skipping Node.js dependencies\"\r\nfi\r\n\r\n# --- Restore or fresh install ---\r\nif [ \"$REINSTALL\" == \"true\" ]; then\r\n    echo -e \"$LINE\"\r\n    log_info \"Restoring MongoDB backup...\"\r\n    echo -e \"$LINE\"\r\n    run_or_fail \"Extract backup\" tar xf /tmp/mongodb_backup.tar.gz -C /mnt/server\r\n    rm -f /tmp/mongodb_backup.tar.gz\r\nelse\r\n    echo -e \"$LINE\"\r\n    log_info \"Fresh install: creating MongoDB directory\"\r\n    echo -e \"$LINE\"\r\n    mkdir -p /mnt/server/mongodb\r\nfi\r\n\r\necho -e \"$LINE\"\r\nlog_success \"Installation of ${APPNAME} completed!\"\r\necho -e \"$LINE\"\r\nexit 0\r\n",
            "container": "ghcr.io/goover/installers:nodejs",
            "entrypoint": "bash"
        }
    },
    "variables": [
        {
            "sort": 1,
            "name": "JS file",
            "description": "The file that starts the app",
            "env_variable": "JS_FILE",
            "default_value": "index.js",
            "user_viewable": false,
            "user_editable": false,
            "rules": [
                "required",
                "string"
            ]
        },
        {
            "sort": 2,
            "name": "MongoDB URL",
            "description": "",
            "env_variable": "MONGO_URL",
            "default_value": "mongodb://127.0.0.1:27017/botdb",
            "user_viewable": true,
            "user_editable": false,
            "rules": [
                "required",
                "string"
            ]
        }
    ]
}